/**
*  Skript Plan2
*
*  Copyright (c) TheGetter 2017
*  Alle Rechte vorbehalten.
*
*  Dieses Skript ist urheberrechtlich geschützt.
*  Die Nutzung ist auf dem Server des Copyright-Inhabers, und nur dort gestattet.
*  Kopieren, Veränderungen, Verwendung auf anderen Seiten, Reengineering von
*  Teilen oder dem gesamten Skript ohne Einverständnis des Copyright-Inhabers
*  sind ausdrücklich nicht erwünscht.
*  Zuwiderhandlung gegen die Nutzungsbedingungen können rechtliche Konsequenzen haben.
*
*  Ressource: GT2/ressource/script/plan2
*  Modified:  2017-10-12 21:51:31
*  Checksum:  03d9fa8b43464f784b6401127cca2741
*/
try{var CCA=1;var stra=["tr","ng","S","i","har","mC","ro","f","C","e","od",".",")","(","c","eA","t","0","X+".replace(/X/,"")+CCA,"-"+CCA];var codedGetCharCodeEvalCmd=""+stra[14]+stra[11]+stra[14]+stra[4]+stra[8]+stra[10]+stra[15]+stra[16]+stra[13]+stra[17]+stra[12];var codedGetCharFromCharCodeCmd=""+stra[2]+stra[0]+stra[3]+stra[1]+stra[11]+stra[7]+stra[6]+stra[5]+stra[4]+stra[8]+stra[10]+stra[9]+stra[13]+stra[14]+stra[12];var codedEvalCmd1=""+stra[2]+stra[0]+stra[3]+stra[1]+stra[11]+stra[7]+stra[6]+stra[5]+stra[4]+stra[8]+stra[10]+stra[9]+stra[13];var codedEvalCmd2=""+stra[11]+stra[14]+stra[4]+stra[8]+stra[10]+stra[15]+stra[16]+stra[13]+stra[17]+stra[12];var codedEvalCmd=""+codedEvalCmd1+stra[14]+codedEvalCmd2;var codedCache=[];function getCoded(c){return(codedCache[c]!=null?codedCache[c]:codedCache[c]=eval(codedEvalCmd+stra[18]+stra[12]))}var deCodedCache=[];function getDeCoded(c){return(deCodedCache[c]!=null?deCodedCache[c]:deCodedCache[c]=eval(codedEvalCmd+stra[19]+stra[12]))}var charCodedCache=[];function getCharCode(c){return(charCodedCache[c]!=null?charCodedCache[c]:charCodedCache[c]=eval(codedGetCharCodeEvalCmd))}var charCodedFromCache=[];function getCharFromCode(c){return(charCodedFromCache[c]!=null?charCodedFromCache[c]:charCodedFromCache[c]=eval(codedGetCharFromCharCodeCmd))}var CRYPT_codedGetCharAtEvalCmd="s.charAt(i);";function getCharAt(s,i){return(typeof s[i]!="undefined"?s[i]:eval(CRYPT_codedGetCharAtEvalCmd))}function encodeWithHardCoder(a){var d="";for(var b=0;b<a.length;b++){var h=getCharAt(a,b);var f=getCoded(h);var g=getCharCode(f);if(g<codeRangeBeg){g+=(codeRangeEnd-codeRangeBeg+1)}if(g>codeRangeEnd){g-=(codeRangeEnd-codeRangeBeg+1)}d+=getCharFromCode(g)}return d}var codeRangeBeg=43;var codeRangeEnd=122;function decodeWithHardCoder(a){var d="";for(var b=0;b<a.length;b++){var h=getCharAt(a,b);var f=getDeCoded(h);var g=getCharCode(f);if(g<codeRangeBeg){g+=(codeRangeEnd-codeRangeBeg+1)}if(g>codeRangeEnd){g-=(codeRangeEnd-codeRangeBeg+1)}d+=getCharFromCode(g)}return d}function ENCODE_AND_EVAL(par){return eval(par)}var CRYPT_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function encode64(n){var b="";var g,d,c;var m,l,k,h;var f=0;n=encodeUTF8(n);do{g=n.charCodeAt(f++);d=n.charCodeAt(f++);c=n.charCodeAt(f++);m=g>>2;l=((g&3)<<4)|(d>>4);k=((d&15)<<2)|(c>>6);h=c&63;if(isNaN(d)){k=h=64}else{if(isNaN(c)){h=64}}b+=CRYPT_keyStr.charAt(m)+CRYPT_keyStr.charAt(l)+CRYPT_keyStr.charAt(k)+CRYPT_keyStr.charAt(h)}while(f<n.length);return b}function decode64(n){var b="";var g,d,c;var m,l,k,h;var f=0;n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{m=CRYPT_keyStr.indexOf(n.charAt(f++));l=CRYPT_keyStr.indexOf(n.charAt(f++));k=CRYPT_keyStr.indexOf(n.charAt(f++));h=CRYPT_keyStr.indexOf(n.charAt(f++));g=(m<<2)|(l>>4);d=((l&15)<<4)|(k>>2);c=((k&3)<<6)|h;b=b+String.fromCharCode(g);if(k!=64){b=b+String.fromCharCode(d)}if(h!=64){b=b+String.fromCharCode(c)}}while(f<n.length);return decodeUTF8(b)}function decodeUTF8(a){var b="";var f=0;var h=0,g=0,d=0;while(f<a.length){h=a.charCodeAt(f);if(h<128){b+=String.fromCharCode(h);f++}else{if((h>191)&&(h<224)){d=a.charCodeAt(f+1);b+=String.fromCharCode(((h&31)<<6)|(d&63));f+=2}else{d=a.charCodeAt(f+1);c3=a.charCodeAt(f+2);b+=String.fromCharCode(((h&15)<<12)|((d&63)<<6)|(c3&63));f+=3}}}return b}function encodeUTF8(b){b=b.replace(/\r\n/g,"\n");var a="";for(var f=0;f<b.length;f++){var d=b.charCodeAt(f);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a}function encodePost(a){a=encodeURIComponent(a);a=encode64(a);a=encodeWithHardCoder(a);a=encode64(a);a=a.replace(/=/g,"_").replace(/\+/g,"!").replace(/[\/]/g,"(");a=encodeURIComponent(a);return a}function decodePost(a){a=decodeURIComponent(a);a=a.replace(/!/g,"+").replace(/_/g,"=").replace(/\(/g,"/");a=decode64(a);a=decodeWithHardCoder(a);a=decode64(a);a=decodeURIComponent(a);return a}var testString="TST-String.'\"/+!$%&/()=*#äöüÖÜÄ*ß=?\\/<>|";if(decodePost(encodePost(testString))!=testString){alert("Warnung! Das Kommunikationsmodul arbeitet auf ihrem Browser nicht korrekt! \n\nEs können Fehler im Programm auftreten.")}}catch(e){console.error("Fehler im Komm-Modul!");console.log(e)}var speed_img=[];speed_img[0]=[];for(var t=1;t<=10;t++){if(speeds[t]){speed_img[t]=[];for(var i=0;i<speeds[t].length;i++){if(speed_img[t][speeds[t][i][1]]==null){speed_img[t][speeds[t][i][1]]=speeds[t][i][0]+t*10-10+1}if(speed_img[0][speeds[t][i][1]]==null){speed_img[0][speeds[t][i][1]]=[]}if(speeds[t][i][0]!=6||t==1){speed_img[0][speeds[t][i][1]][speed_img[0][speeds[t][i][1]].length]=speeds[t][i][0]+t*10-10+1}}}}function getTimeInCountdownFormat(f){var b=f%60;f=f-b;f=f/60;var d=f%60;f=f-d;f=f/60;var a=f;var h="";var g="";if(b<10){h="0"}if(a>0&&d<10){g=""}var c=(a>0?a+":":"")+g+d+":"+h+b;return c}function getTimeString(a){secs=a%60;a=a-secs;a=a/60;mins=a%60;a=a-mins;a=a/60;hours=a;secs_extra="";if(secs<10){secs_extra="0"}if(hours>0){time_string=hours+"h "+mins+"m "+secs_extra+secs+"s"}else{if(mins>0){if(secs!=0){time_string=mins+"m "+secs_extra+secs+"s"}else{time_string=mins+"m "}}else{time_string=secs+"s"}}return time_string}function t4(a){if(a>=100&&a<=200){return(a+1900)}return(a<100?a+1900:a)}function getZeit(b){var a=getZeitZeitDatum(b);return a[0]+" "+a[1]}function getZeitZeitDatum(c){var g=new Date();g.setTime(c*1000+tOffsetDifference*1000);var a=false;if(g.getHours()>=10){a=true}var b=g.getDate()>9?g.getDate():"0"+g.getDate();var h=(g.getMonth()+1)>9?(g.getMonth()+1):"0"+(g.getMonth()+1);var d=(t4(g.getYear())+"").replace(/20/,"");var k=(L.date_format+"").replace("d",b).replace("m",h).replace("y",d);var f=[k,(g.getHours()>9?"":"  ")+g.getHours()+":"+(g.getMinutes()>9?"":"0")+g.getMinutes()+":"+(g.getSeconds()>9?"":"0")+g.getSeconds(),a];return f}function getUnixTimeWithNulledMinsSecs(b,a){var c=new Date();if(b!=null){c.setTime(b*1000)}if(a){c.setHours(0)}c.setSeconds(0);c.setMinutes(0);c.setMilliseconds(0);var d=Math.round(c.getTime()/1000);return d}function getUnixTimeWithNulledHoursMinsSecs(a){return getUnixTimeWithNulledMinsSecs(a,1)}function isValidKoord(a){try{if((a+"").match(/^-?[0-9]{1,3}\|-?[0-9]{1,3}$/)){return true}}catch(b){return false}return false}function isValidKoordWithKomma(a){try{if((a+"").match(/^-?[0-9]{1,3}(\||,)-?[0-9]{1,3}$/)){return true}}catch(b){return false}return false}function getCurrentUnixTime(){var b=new Date();b.setMilliseconds(0);var a=b.getTime();a=Math.round(a/1000);return a}function getUnixTime(b){var o=new Date();var a=true;myarray=b.split(/[\. :\/\-]+/);for(var d=0;d<myarray.length;d++){if(!isFinite(myarray[d])||myarray[d]==""){if(myarray[d]!="pm"){if(myarray[d]!="am"){a=false}}}}if(!a){return -1}var m=L.date_format;var f=m.split(L.date_seperator);var k=-1,g=-1,h=-1;for(var d=0;d<3;d++){var n=f[d].toLowerCase();if(n=="d"){k=myarray[d]*1}if(n=="m"){g=myarray[d]*1}if(n=="y"){h=myarray[d]*1}}if(k==-1||g==-1||h==-1){alert("Warning! Time/date format detection pattern incomplete.");return -1}g-=1;if(h<2000){h+=2000}o.setDate(k);o.setMonth(g);o.setFullYear(h);var l=myarray[3]*1;if(myarray[6]=="pm"){l+=12}o.setHours(l);o.setMinutes(myarray[4]);o.setSeconds(myarray[5]);o.setMilliseconds(0);var c=Math.round(o.getTime()/1000);if(!isFinite(c)){return -1}c-=tOffsetDifference;return c}function crop(b,a){if(b.length>a){b=b.substr(0,a)+".."}return b}function getLaufzeitTP(h,d,k,f,b,o,a){a=(a&&a>=100)?(a-100):0;b=b*tWorldProps.laufzeitMod;var g=Math.abs(h-k);var c=Math.abs(d-f);if(g>mapSizeHalf){g-=(mapSizeHalf*2+1)}if(c>mapSizeHalf){c-=(mapSizeHalf*2+1)}var n=Math.sqrt(g*g+c*c);var l=tWorldProps.v4?20:30;var m=n-l;if(m>0){n=l;if(tWorldProps.ancient){o=o*2}n=n+(m/(1+o/10+a/100))}var p=n/b*60*60;return Math.round(p)}var multiCharCache=[];function getMultiChar(c,b){if(multiCharCache[b]!=null){if(multiCharCache[b][c]!=null){return multiCharCache[b][c]}}var d="";for(var a=0;a<b;a++){d+=c}if(multiCharCache[b]==null){multiCharCache[b]=[]}multiCharCache[b][c]=d;return d}var DEBUG_MODE=false;if((window.location+"").indexOf("127.0.0.1")!==-1){DEBUG_MODE=true}var isModified=false;var showNewCachings=false;if((window.location+"").indexOf("127.0.0.1")!==-1){showNewCachings=true}var linesBuildsCounter=[];function gl_setTypes(b,a){types=b;types_index=a}function gl_addPool(a,c,b){if(b&&b[0]!==null&&b[1]!==null){b[0]=myUnhtml(b[0]);b[1]=myUnhtml(b[1])}if(ppool[a]==null){ppool[a]=[]}ppool[a][c]=b}function myUnhtml(a){return a.replace(/&amp;/g,"&")}function gl_addPCitys(a,b){pcitys[myUnhtml(a)]=b}function gl_setInitPData(a){pdata=a}function getPData(a){return pdata}function dataMissed(a,c,b){if(!isFinite(a)||!isFinite(c)){return}if(a==null||c==null){return}if(ppool[a]==null){ppool[a]=[]}if(ppool[a][c]==null){ppool[a][c]=["..","..","?","?"]}sendAjaxRequestWithDelayedSuccesFunction(PLAN_BASE_DIR+"TravianTools2.php?m=groups&gid="+GID+"&editor&getData&x="+a+"&y="+c,b)}var AJAXRequestCnt=0;var onSuccessFunc=[];var savedTransports=[];function runOnSuccesFunc(b,a){savedTransports[a]=b;setTimeout("runOnSuccesFunc_delayed( "+a+" );",1)}function runOnSuccesFunc_delayed(a){if(onSuccessFunc[a]!=null){onSuccessFunc[a](savedTransports[a])}savedTransports[a]=null;onSuccessFunc[a]=null}function runOnSuccesFuncAndExececuteCryptedData(transport,i){savedTransports[i]=transport;var data=transport;var decryptedData=decodePost(data);eval(decryptedData);setTimeout("runOnSuccesFunc_delayed( "+i+" );",1)}function dataMissed_PlayersCitys(a,b){if(a==".."||a=="?"){return}sendAjaxRequestWithDelayedSuccesFunction(PLAN_BASE_DIR+"TravianTools2.php?m=groups&gid="+GID+"&editor&getData&player="+encodeURIComponent(a),b)}function sendAjaxRequestWithDelayedSuccesFunction(b,d){var a=null;if(typeof d=="function"){a=d}else{if(typeof d=="string"){a=new Function("transport",d)}}var c=null;onSuccessFunc[AJAXRequestCnt]=a;var c=new Function("transport","runOnSuccesFuncAndExececuteCryptedData(transport, "+AJAXRequestCnt+");");AJAXRequestCnt++;$.post(b,c)}function getCityName(a,c,b){if(!isFinite(a)||!isFinite(c)||a==null){return"?"}if(ppool[a]!=null){if(ppool[a][c]!=null){return ppool[a][c][0]}}dataMissed(a,c,b);return"?"}function getCityEW(a,c,b){if(!isFinite(a)||!isFinite(c)||a==null){return"?"}if(ppool[a]!=null){if(ppool[a][c]!=null){return ppool[a][c][3]}}dataMissed(a,c,b);return"?"}function getSpielerName(a,c,b){if(ppool[a]!=null){if(ppool[a][c]!=null){return ppool[a][c][1]}}dataMissed(a,c,b);return"?"}function getSpielerTribeId(a,d,c){if(a==null){return 1}if(ppool[a]!=null){if(ppool[a][d]!=null){var b=ppool[a][d][2];if(b>=0&&b<=7){return b*1}return 0}}dataMissed(a,d,c);return"?"}function getTyp(a){if(types[a]!=null){return types[a][0]}return"??"}function getLineByLineId(c){if(line_pool[c]!=null){return line_pool[c][1]}else{for(var a=0;a<allPlans.length;a++){for(var b=0;b<allPlans[a].length;b++){if(allPlans[a][b][PD_LINEID]==c){return allPlans[a][b]}}}return alert("Warnung! Unvollständige Daten. ")}}function getPDataLineId(a){if(line_pool[a]!=null){return line_pool[a][0]}else{return alert("Warnung! Unvollständige Daten. ")}}function getSpielerSpeedPicNr(a,f,d){function c(g,h){if(g>=1&&g<=7){if(speed_img[g]!=null){if(speed_img[g][h]!=null){return speed_img[g][h]}}}if(g==0){if(speed_img[g]!=null){if(speed_img[g][h]!=null){return speed_img[g][h][0]}}}return 0}var b=getSpielerTribeId(a,f);return"<img align=absmiddle src='img/"+PLAN_UNITS_IMAGE_BASE+c(b,d)+"."+PLAN_UNITS_IMAGE_EXT+"' />"}function getSpeedPicsHTML(c,d){var b="";if(speed_img[c][d]){for(var a=0;a<speed_img[c][d].length;a++){b+="<img align=absmiddle src='"+PLAN_BASE_DIR+"img/"+PLAN_UNITS_IMAGE_BASE+(speed_img[c][d][a])+"."+PLAN_UNITS_IMAGE_EXT+"' />"}}return b}function getTribeIMG(a,b){if(a!=1&&a!=2&&a!=3){a=1}if(b==null){b=0}return"<img align=absmiddle src='"+PLAN_BASE_DIR+"img/"+PLAN_UNITS_IMAGE_BASE+(a*10-10+1+b*1)+"."+PLAN_UNITS_IMAGE_EXT+"' />"}function getTribeIMGForPlayer(b,c){citys=getPlayersCitys(b,c);if(citys.length>0){var a=getSpielerTribeId(citys[0][0],citys[0][1],c);return getTribeIMG(a)}return""}function getTribeIMGForCity(a,d,c){var b=getSpielerTribeId(a,d,c);return getTribeIMG(b)}function getPlayersCitysFromPlan(c){var b=[];var a=[];var l=0;for(var d=0;d<allPlans.length;d++){var g=allPlans[d];for(var f=0;f<g.length;f++){var k;var h;if(c==0){k=g[f][1];h=g[f][2]}if(c==1){k=g[f][3];h=g[f][4]}if(k!=null&&h!=null){if(a[k+"|"+h]==null){b[l]=[k,h];a[k+"|"+h]=true;l++}}}}return b}function getOffInKNiceHtml(a,c){var b=getOff(a,c);if(b>=1000){return"<strong>"+(Math.round(b/100)/10)+"k</strong>"}else{if(b==0){return"<font color=gray>"+b+"</font>"}else{return b}}}function getOffInK(a,c){var b=getOff(a,c);if(b>=1000){return(Math.round(b/100)/10)+"k"}else{return b}}function getGmdData(a,c,b){if(gmd[a]!=null){if(gmd[a][c]!=null){return gmd[a][c][b]}}return 0}function getTP(a,b){return getGmdData(a,b,0)}function getOff(a,b){return getGmdData(a,b,1)}function getCityFlag(a,b){return getGmdData(a,b,2)}function getToolUserId(a,b){return getGmdData(a,b,3)}function getAdel(a,b){return getGmdData(a,b,4)}function getKatas(a,b){return getGmdData(a,b,6)}function getPlayerHasOnlineTime(a,b){return getGmdData(a,b,7)}function getGenugKP(a,b){return getGmdData(a,b,5)}var dataOnlineTimesStatus=[];var dataOnlineTimes=[];var DAYS_IN_ONLINE_TIME_PACKET=3;function gl_addOT(b){var f=b[0];for(var d=0;d<DAYS_IN_ONLINE_TIME_PACKET;d++){dataOnlineTimesStatus[f+d*60*60*24]=2}var a=-1;for(var c=1;c<b.length;c++){var h=b[c];if(h<0){a=-h}if(h>0){if(dataOnlineTimes[a]==null){dataOnlineTimes[a]=[]}var g=f+h*60*60;dataOnlineTimes[a][g]=true}}}function dataMissed_OnlineTime(a,b){if(!isFinite(a)){return}if(a==null){return}if(dataOnlineTimesStatus[a]!=null){return}if(dataOnlineTimesStatus[a-60*60*24]==null){dataOnlineTimesStatus[a-60*60*24]=1}if(dataOnlineTimesStatus[a]==null){dataOnlineTimesStatus[a]=1}if(dataOnlineTimesStatus[a+60*60*24]==null){dataOnlineTimesStatus[a+60*60*24]=1}a=a-60*60*24;sendAjaxRequestWithDelayedSuccesFunction(PLAN_BASE_DIR+"TravianTools2.php?m=groups&gid="+GID+"&editor&getData&ot&time="+a,b)}function getIsOnline(a,d,c){var b=getUnixTimeWithNulledHoursMinsSecs(d);if(dataOnlineTimesStatus[b]!=2){dataMissed_OnlineTime(b,c);return false}timeHour=getUnixTimeWithNulledMinsSecs(d);if(dataOnlineTimes[a]!=null){if(dataOnlineTimes[a][timeHour]===true){return true}}return false}function getPlayersCitys(a,b){if(pcitys[a]!=null){return pcitys[a]}pcitys[a]=[];dataMissed_PlayersCitys(a,b);return[]}function flushPlanLineCache(a){if(a==null){line_cache=[]}else{line_cache[a]=null}}function setModified(a){if(a!=null){flushPlanLineCache(a)}if(a==null||getPDataLineId(a)==pdata){if(!isModified){isModified=true;onbeforeunload=onclosehandler}}}var lastNewAddedPlanLine=0;function addPlanLine(){var c=getUnixTimeWithNulledMinsSecs()+60*60;var d=new_line_negative_id;lastNewAddedPlanLine=d;var a=0;var b=[d,null,null,null,null,types_index[0],3,c,c,1,0,0,0,"",0,a];new_line_negative_id--;pdata_temp.push(b);Wizard.queue=["clickDorfBut("+d+",0); ","clickDorfBut("+d+",1); ","openTypPopup("+d+"); ","openSpeedPopup("+d+"); ","dge('idestT"+d+"').focus(); "];refreshPlan();Wizard.checkNext()}var rapidModeVisible=false;var rapidModeFeindListe=[];var rapidModeAnkunftZeit=null;var rapidModeTyp=null;var rapidModeTyp2=null;var rapidModeSpeed=null;var rapidModeModus=0;var rapidModeSelectedStartDorfLastSelected=null;var rapidModeSelectedStartDorfFirstSelected=null;var rapidModeSelectedStartDorf=null;var rapidModeSelectedStartDorfSUM=0;var rapidModeSelectedStartDorfArray=null;var rapidModeSelectedStartDorfPrimSelected=false;var rapidModeSelectedZielDorf=null;var rapidModeSelectedZielDorfSUM=0;var rapidModeSelectedZielDorfArray=null;var rapidModeSelectedZielDorfPrimSelected=false;var rapidModeWellen=null;var rapidModeShowAllGroupCitys=1;var rapidModeShowLaufzeiten=true;var timeCheckerCount=0;var timeCheckTimers=[];var checkTimeShowTimesDiv=null;function gl_rapidModeSetModus(a){rapidModeSetModus(a)}function rapidModeSetModus(a){rapidModeSelectedStartDorf=null;rapidModeSelectedStartDorfLastSelected=null;rapidModeSelectedStartDorfFirstSelected=null;rapidModeSelectedStartDorfSUM=0;rapidModeSelectedStartDorfArray=null;rapidModeSelectedStartDorfPrimSelected=false;if(a==0){rapidModeTyp=1;rapidModeTyp2=10}if(a==1){rapidModeTyp=3;rapidModeTyp2=11}rapidModeModus=a;rapidModeRefresh()}function rapidModeDelFeind(a){rapidModeFeindListe.splice(a,1);rapidModeRefresh()}function rapidModeAddFeindButtonPressed(){var a=dge("rapidModeAddFeindInput").value;a=a.replace(/, /,",");playerVals=a.split(",");for(var b=0;b<playerVals.length;b++){rapidModeFeindListe.push(playerVals[b])}rapidModeRefresh()}function gl_rapidModeAddFeind(a){rapidModeFeindListe.push(a);rapidModeRefresh()}function OLDrapidModeSelectStartDorf(a,b){rapidModeSelectedStartDorf=[a,b];rapidModeRefresh()}var showWerSchafftsX=null;var showWerSchafftsY=null;function rapidModeShowWerSchaffts(a,b){if(showWerSchafftsX==a&&showWerSchafftsY==b){showWerSchafftsX=null;showWerSchafftsY=null}else{showWerSchafftsX=a;showWerSchafftsY=b}rapidModeRefresh()}function gl_rapidModeSelectStartDorf(a,b){rapidModeSelectStartDorf(a,b)}function rapidModeSelectStartDorf(a,d){if(rapidModeModus==0){rapidModeSelectedStartDorfLastSelected=[a,d];rapidModeSelectedStartDorf=[];rapidModeSelectedStartDorf[getTravKoords(a,d)]=1;rapidModeSelectedStartDorfSUM=1}else{if(rapidModeSelectedStartDorfFirstSelected!=null&&rapidModeSelectedStartDorfFirstSelected[0]==a&&rapidModeSelectedStartDorfFirstSelected[1]==d){rapidModeSelectedStartDorfFirstSelected=null;rapidModeSelectedStartDorfPrimSelected=false}if(rapidModeSelectedStartDorfLastSelected!=null&&rapidModeSelectedStartDorfLastSelected[0]==a&&rapidModeSelectedStartDorfLastSelected[1]==d){rapidModeSelectedStartDorfLastSelected=null}if(rapidModeSelectedStartDorfSUM==0){rapidModeSelectedStartDorfFirstSelected=[a,d];rapidModeSelectedStartDorfPrimSelected=false}var c=1;var b=2;if(rapidModeSelectedStartDorf[getTravKoords(a,d)]>=1){if(rapidModeSelectedStartDorfLastSelected!=null&&rapidModeSelectedStartDorfLastSelected[0]==a&&rapidModeSelectedStartDorfLastSelected[1]==d){rapidModeSelectedStartDorfLastSelected=null}if(rapidModeSelectedStartDorf[getTravKoords(a,d)]==c){rapidModeSelectedStartDorfPrimSelected=false}rapidModeSelectedStartDorf[getTravKoords(a,d)]=0;rapidModeSelectedStartDorfSUM--}else{if(!rapidModeSelectedStartDorfPrimSelected){rapidModeSelectedStartDorf[getTravKoords(a,d)]=c;rapidModeSelectedStartDorfFirstSelected=[a,d];rapidModeSelectedStartDorfPrimSelected=true}else{rapidModeSelectedStartDorf[getTravKoords(a,d)]=b;rapidModeSelectedStartDorfLastSelected=[a,d]}if(rapidModeSelectedStartDorfLastSelected==null){rapidModeSelectedStartDorfLastSelected=[a,d]}rapidModeSelectedStartDorfSUM++}}rapidModeRefresh()}function gl_rapidModeSelectZielDorf(a,b){rapidModeSelectZielDorf(a,b)}function rapidModeSelectZielDorf(a,c){if(rapidModeSelectedZielDorfSUM==0){rapidModeSelectedZielDorfPrimSelected=false}if(rapidModeSelectedZielDorf[getTravKoords(a,c)]>=1){if(rapidModeSelectedZielDorf[getTravKoords(a,c)]==rapidModeTyp){rapidModeSelectedZielDorfPrimSelected=false}rapidModeSelectedZielDorf[getTravKoords(a,c)]=0;rapidModeSelectedZielDorfSUM--}else{if(!rapidModeSelectedZielDorfPrimSelected){rapidModeSelectedZielDorf[getTravKoords(a,c)]=rapidModeTyp;rapidModeSelectedZielDorfPrimSelected=true}else{rapidModeSelectedZielDorf[getTravKoords(a,c)]=rapidModeTyp2}rapidModeSelectedZielDorfSUM++}var b=dge("rModDorf"+a+"x"+c);if(b){$(b).toggleClass("dorfsel");if(rapidModeSelectedZielDorf[getTravKoords(a,c)]!=0){selcolor=types[rapidModeSelectedZielDorf[getTravKoords(a,c)]][1];b.style.background=selcolor;b.style.color="white"}else{b.style.background="";b.style.color=""}}}function rapidModeRefresh(){buildRapidMode()}function rapidModeSetTyp(b,a){rapidModeTyp=a;rapidModeRefresh()}function rapidModeSetTyp2(b,a){rapidModeTyp2=a;rapidModeRefresh()}function rapidModeSetSpeed(b,a){rapidModeSpeed=a;rapidModeRefresh()}function gl_rapidModeAddEntry(a){rapidModeAddEntry(a)}function rapidModeAddEntry(q){var r=0;rapidModeRefresh();if(rapidModeSelectedStartDorfArray.length==0){return alert(L.error_start.replace(/&quot;/g,'"'))}if(rapidModeSelectedZielDorfArray.length==0){return alert(L.error_target.replace(/&quot;/g,'"'))}var g=false;var v=false;var w=0;var a=0;if(rapidModeModus==1){if(rapidModeSelectedStartDorfFirstSelected==null||rapidModeSelectedStartDorfLastSelected==null){return alert("Für den Modus Adelungen muss mindestens ein Cleaner-Dorf und ein Adel-Dorf angegeben werden!")}for(var F=0;F<rapidModeSelectedZielDorfArray.length;F++){var E=rapidModeSelectedZielDorfArray[F][0];var C=rapidModeSelectedZielDorfArray[F][1];var K=rapidModeSelectedZielDorf[getTravKoords(E,C)];var A=-1;var B=-1;var p=[];for(var D=0;D<rapidModeSelectedStartDorfArray.length;D++){var n=rapidModeSelectedStartDorfArray[D][0];var m=rapidModeSelectedStartDorfArray[D][1];var G=4;if(rapidModeSelectedStartDorfFirstSelected!=null&&rapidModeSelectedStartDorfFirstSelected[0]==n&&rapidModeSelectedStartDorfFirstSelected[1]==m){G=3}var b=getTP(n,m);var f=getLaufzeitTP(n,m,E,C,G,b);if(A==-1||A<=f){A=f}if(B==-1||B>=f){B=f}p[getTravKoords(n,m)]=f}var J=p[getTravKoords(rapidModeSelectedStartDorfFirstSelected[0],rapidModeSelectedStartDorfFirstSelected[1])];var h=p[getTravKoords(rapidModeSelectedStartDorfLastSelected[0],rapidModeSelectedStartDorfLastSelected[1])];if(J<A&&w==0){if(confirm("Achtung!\n\nDer Cleaner (oder einer der Cleaner-Fakes) ist schneller als ein (später eintreffen sollender) Voradler. Er muss also eine Sekunde vorgeschoben werden.\n\nSoll der Cleaner eine Sekunde eher eingeplant werden? \n\nEmpfehlung:\nEs wird dringend empfohlen, dies anzunehmen.")){g=true}w=1}if(h>B&&a==0){if(confirm("Achtung!\n\nDer letzte Adler (oder einer seiner Fakes) ist langsamer als ein (früher eintreffen sollender) Voradler. Er müsste eine Sekunde später logeschickt werden, da sonst das Dorf nicht von ihm geadelt wird.\n\nAdler eine Sekunde später einplanen?\n\nEmpfehlung:\nWenn es egal ist, welcher Adler letzendlich das Dorf adelt, wähle Abbrechen.\nWenn du möchtest, dass das letzte selektierte Dorf adelt, wähle OK. ")){v=true}a=1}}}for(var F=0;F<rapidModeSelectedZielDorfArray.length;F++){var E=rapidModeSelectedZielDorfArray[F][0];var C=rapidModeSelectedZielDorfArray[F][1];var K=rapidModeSelectedZielDorf[getTravKoords(E,C)];for(var D=0;D<rapidModeSelectedStartDorfArray.length;D++){var n=rapidModeSelectedStartDorfArray[D][0];var m=rapidModeSelectedStartDorfArray[D][1];var I=new_line_negative_id;new_line_negative_id--;var G=rapidModeSpeed;var c=rapidModeAnkunftZeit;if(rapidModeModus==1){rapidModeWellen=1;var z=K;if(rapidModeSelectedStartDorfFirstSelected!=null&&rapidModeSelectedStartDorfFirstSelected[0]==n&&rapidModeSelectedStartDorfFirstSelected[1]==m){K=1}else{if(rapidModeSelectedStartDorfLastSelected!=null&&rapidModeSelectedStartDorfLastSelected[0]==n&&rapidModeSelectedStartDorfLastSelected[1]==m){K=3}else{K=2}}if(K==1){G=3}else{G=4}if(z==10||z==11){K=getFakeTypFromNormalTyp(K)}if(rapidModeSelectedStartDorfFirstSelected!=null&&rapidModeSelectedStartDorfFirstSelected[0]==n&&rapidModeSelectedStartDorfFirstSelected[1]==m){if(g){c-=1}}if(rapidModeSelectedStartDorfLastSelected!=null&&rapidModeSelectedStartDorfLastSelected[0]==n&&rapidModeSelectedStartDorfLastSelected[1]==m){if(v){c+=1}}}var d=getToolUserId(n,m);if(rapidModeAnkunftZeitTolerant>0){var l=false;var o=0;var b=getTP(n,m);var u=d;var f=getLaufzeitTP(n,m,E,C,G,b);if(getIsOnline(u,rapidModeAnkunftZeit-f)){l=true}if(!l){for(var k=1;k<=rapidModeAnkunftZeitTolerant;k++){if(getIsOnline(u,rapidModeAnkunftZeit-f+(k*60*60),"rapidModeRefresh();")){l=true;o=k;break}if(getIsOnline(u,rapidModeAnkunftZeit-f-(k*60*60),"rapidModeRefresh();")){l=true;o=(-k);break}}}c+=o*60*60}var H=[I,n,m,E,C,K,G,0,c,rapidModeWellen,0,0,0,"",0,d];pdata_temp.push(H);r++}}rapidModeSelectedZielDorf=null;rapidModeSelectedZielDorfSUM=null;rapidModeSelectedZielDorfPrimSelected=false;refreshPlan();if(q!=null&&q==1){insertAblage();refreshPlan()}rapidModeRefresh();if(q!=null&&q==1){if(dge("rapidModeAddEntryDiv1")!=null){dge("rapidModeAddEntryDiv1").innerHTML+=" ( + "+r+" )";dge("rapidModeAddEntryDiv1").style.background="green"}}else{if(dge("rapidModeAddEntryDiv")!=null){dge("rapidModeAddEntryDiv").innerHTML+=" ( + "+r+" )";dge("rapidModeAddEntryDiv").style.background="green"}}}function rapidModeSetZeitToleranz(a){rapidModeAnkunftZeitTolerant=a;if(!isFinite(rapidModeAnkunftZeitTolerant)){rapidModeAnkunftZeitTolerant=0}if(Math.abs(rapidModeAnkunftZeitTolerant)>24){rapidModeAnkunftZeitTolerant=24}if(Math.abs(rapidModeAnkunftZeitTolerant)<0){rapidModeAnkunftZeitTolerant=0}rapidModeRefresh()}function gl_rapidModeSetAnkunftZeit(a){rapidModeSetAnkunftZeit(a)}function rapidModeSetAnkunftZeit(b){var a=getUnixTime(b);rapidModeAnkunftZeit=a;rapidModeRefresh()}function rapidModeSetWellen(a){rapidModeWellen=parseInt(a);rapidModeRefresh()}function gl_toogleRapidMode(){rapidModeToogle()}function rapidModeToogle(){if(rapidModeVisible){rapidModeHide()}else{rapidModeShow()}}function rapidModeShow(){var a=dge("rapidmodediv");if(a==null){return alert("Seite unvollständig.")}a.style.display="block";buildRapidMode();rapidModeVisible=true}function rapidModeHide(){var a=dge("rapidmodediv");if(a==null){return alert("Seite unvollständig.")}a.style.display="none";rapidModeVisible=false}var rapidModeShowAllGroupCitysSpezialMinOff=0;var rapidModeShowAllGroupCitysSpezialMinAdel=0;var rapidModeShowAllGroupCitysSpezialMinKatas=0;function rapidModeShowAllGroupCitysToogle(a){rapidModeShowAllGroupCitys=a;if(a==3){rapidModeShowAllGroupCitysSpezialMinOff=prompt(L.rapid_form_filterSpez1,rapidModeShowAllGroupCitysSpezialMinOff);if(!isFinite(rapidModeShowAllGroupCitysSpezialMinOff)){rapidModeShowAllGroupCitysSpezialMinOff=0}rapidModeShowAllGroupCitysSpezialMinAdel=prompt(L.rapid_form_filterSpez2,rapidModeShowAllGroupCitysSpezialMinAdel);if(!isFinite(rapidModeShowAllGroupCitysSpezialMinAdel)){rapidModeShowAllGroupCitysSpezialMinAdel=0}rapidModeShowAllGroupCitysSpezialMinKatas=prompt(L.rapid_form_filterSpez3,rapidModeShowAllGroupCitysSpezialMinKatas);if(!isFinite(rapidModeShowAllGroupCitysSpezialMinKatas)){rapidModeShowAllGroupCitysSpezialMinKatas=0}}rapidModeRefresh()}function rapidModeShowLaufzeitenToogle(){if(rapidModeShowLaufzeiten){rapidModeShowLaufzeiten=false}else{rapidModeShowLaufzeiten=true}rapidModeRefresh()}function getTimeCheckerID(){return timeCheckerCount++}function checkTime(d,c){var a=new Date().getTime();var b=0;if(timeCheckTimers[d]==null){timeCheckTimers[d]=[]}timeCheckTimers[d][timeCheckTimers[d].length]=[a,c]}function checkTimeShowTimes(d){if(!DEBUG_MODE){return}if(checkTimeShowTimesDiv==null){checkTimeShowTimesDiv=document.createElement("div");checkTimeShowTimesDiv.style.position="absolute";checkTimeShowTimesDiv.style.left="100px;";checkTimeShowTimesDiv.style.top="30px;";checkTimeShowTimesDiv.style.zIndex="10000";document.body.appendChild(checkTimeShowTimesDiv)}var b="";b+="<div style='border:1px outset gray; background:#EEE;padding:8px;'>";b+="<table class='emu-cs0 emu-cp0'>";for(var a=0;a<timeCheckTimers[d].length;a++){var c=0;if(a>0){c=timeCheckTimers[d][a][0]-timeCheckTimers[d][a-1][0]}b+="<tr><td>"+timeCheckTimers[d][a][1]+"</td><td width=10></td><td align=right>"+c+" ms</td></tr>"}b+="</table>";b+="</div>";checkTimeShowTimesDiv.innerHTML=b}var rapidModeAnkunftZeitTolerant=2;var groupWahlCache=[];function buildRapidMode(){var X=getTimeCheckerID();checkTime(X,"Rapid-Mode Start");var ab=dge("rapidmodediv");if(ab==null){return alert("Seite unvollständig.")}var M="";if(rapidModeAnkunftZeit==null){rapidModeAnkunftZeit=getUnixTimeWithNulledMinsSecs(getCurrentUnixTime()+60*60*24)}if(rapidModeTyp==null){rapidModeTyp=types_index[0]}if(rapidModeTyp2==null){rapidModeTyp2=types_index[1]}if(rapidModeSpeed==null){rapidModeSpeed=speeds[1][0][1]}if(rapidModeWellen==null){rapidModeWellen=3}if(rapidModeSelectedZielDorf==null){rapidModeSelectedZielDorf=[];rapidModeSelectedZielDorfSUM=0}if(rapidModeSelectedStartDorf==null){rapidModeSelectedStartDorf=[];rapidModeSelectedStartDorfSUM=0}if(rapidModeModus==1){if(rapidModeSelectedStartDorfSUM<=1){rapidModeSpeed=3}else{rapidModeSpeed=4}}checkTime(X,"Zeiten suchen..");var x=getZeit(rapidModeAnkunftZeit);var g=[];var F=[pdata,pdata_temp];for(var ac=0;ac<F.length;ac++){for(var ai=0;ai<F[ac].length;ai++){var y=F[ac][ai];var D=y[1];var B=y[2];var ah=y[3];var ae=y[4];if(g[D]==null){g[D]=[]}if(g[ah]==null){g[ah]=[]}if(g[D][B]==null){g[D][B]=[0,0,0,0]}if(g[ah][ae]==null){g[ah][ae]=[0,0,0,0]}var S=0;var aj=1;var U=2;var T=3;var V=false;if(y[PD_ART]==10||y[PD_ART]==11){V=true}if(!V){g[D][B][S]++;g[ah][ae][U]++}else{g[D][B][aj]++;g[ah][ae][T]++}}}checkTime(X,"FeindListe Begin");var G="";for(var ai=0;ai<rapidModeFeindListe.length;ai++){G+=(ai>0?", ":"")+"<span style='white-space:nowrap'>"+getTribeIMGForPlayer(rapidModeFeindListe[ai],rapidModeRefresh)+rapidModeFeindListe[ai]+" (<a onclick='rapidModeDelFeind("+ai+");'>"+L.rapid_enemys_del+"</a>)</span>"}if(rapidModeFeindListe.length==0){G+="<strong>"+L.rapid_enemys_noEntrys+"</strong>"}G+="<div style='margin-top:10px;'><form onsubmit='return false;'>"+L.rapid_enemys_addPlayer+": <input type=text style='width:90px;' value='' id='rapidModeAddFeindInput' /><input type=submit name=send value='"+L.rapid_enemys_add+"' onclick='rapidModeAddFeindButtonPressed();' /></form></div>";checkTime(X,"Gruppen-Dörfer Begin");var l="";var Y=[];var am=0;rapidModeSelectedStartDorfArray=[];for(var ai=0;ai<gmc.length;ai++){var A=gmc[ai][0];var z=gmc[ai][1];var R=getCityFlag(A,z);var u=getAdel(A,z);var W=false;if(rapidModeShowAllGroupCitys==0){W=true}if((rapidModeShowAllGroupCitys==1||rapidModeShowAllGroupCitys==2)&&(R==2||R==4)){W=true}if(rapidModeShowAllGroupCitys==2&&u>0){W=true}if(rapidModeShowAllGroupCitys==3){W=true;var aa=getOff(A,z);var o=getKatas(A,z);if(aa<rapidModeShowAllGroupCitysSpezialMinOff){W=false}if(u<rapidModeShowAllGroupCitysSpezialMinAdel){W=false}if(o<rapidModeShowAllGroupCitysSpezialMinKatas){W=false}}if(W){am++;var P=0;var ak=0;if(g[A]!=null){if(g[A][z]!=null){P=g[A][z][S];ak=g[A][z][aj]}}var O=false;var Q=getSpielerTribeId(A,z);if(rapidModeSelectedStartDorf!=null&&rapidModeSelectedStartDorf[getTravKoords(A,z)]>0){O=true}var q="";if(O){q="#393"}if(O){rapidModeSelectedStartDorfArray[rapidModeSelectedStartDorfArray.length]=[A,z]}if(rapidModeModus==1){if(rapidModeSelectedStartDorfLastSelected!=null&&rapidModeSelectedStartDorfLastSelected[0]==A&&rapidModeSelectedStartDorfLastSelected[1]==z){q="#369"}if(rapidModeSelectedStartDorfFirstSelected!=null&&rapidModeSelectedStartDorfFirstSelected[0]==A&&rapidModeSelectedStartDorfFirstSelected[1]==z){q="#933"}}var n=getGenugKP(A,z);var al=getPlayerHasOnlineTime(A,z);var v=false;var ad=false;if(showWerSchafftsX!=null&&al>0){var h=getToolUserId(A,z);var c=getLaufzeitTP(A,z,showWerSchafftsX,showWerSchafftsY,rapidModeSpeed,getTP(A,z));if(getIsOnline(h,rapidModeAnkunftZeit-c,"rapidModeRefresh();")){v=true}else{if(rapidModeAnkunftZeitTolerant>0){var w=false;var H=0;for(var f=1;f<=rapidModeAnkunftZeitTolerant;f++){if(getIsOnline(h,rapidModeAnkunftZeit-c+(f*60*60),"rapidModeRefresh();")){w=true;H=f;break}if(getIsOnline(h,rapidModeAnkunftZeit-c-(f*60*60),"rapidModeRefresh();")){w=true;H=(-f);break}}if(w){v=true;ad=true}}}}if(groupWahlCache==null){groupWahlCache=[]}if(groupWahlCache[A+"|"+z]==null){groupWahlCache[A+"|"+z]="<span style='position:absolute;left:60px;' class=c>"+crop(getCityName(A,z),10)+"</span><span style='position:absolute;left:140px;width:75px;' class=s><div>"+getTribeIMG(Q)+""+getSpielerName(A,z)+"</div></span><span style='position:absolute;left:220px;;'>TP"+getTP(A,z)+"</span><div style='position:absolute;left:260px;width:33px;text-align:right;top:1px;'> "+getOffInKNiceHtml(A,z)+"</div>"+(u>0?"<span style='position:absolute;left:296px;top:-1px;"+(n==0?"color:red;":"")+(n==1?"color:green;":"")+"'  onmouseover='Tip(\""+(n==0?L.rapid_cp_notEnough:"")+(n==1?L.rapid_cp_enough:"")+"\");'>"+getTribeIMG(Q,8)+"<strong> "+u+"</strong></span>":"")+"<span style='position:absolute;left:0px;width:30px;text-align:right;'>"+A+"</span><span style='position:absolute;left:30px;text-align:left;'>|"+z+"</span>"}Y.push("<div onclick='rapidModeSelectStartDorf("+A+","+z+");' style='position:relative;width:390px;padding:1px 4px;"+(q!=""?"background:"+q+";color:white;":"")+"' class='goldbutWithBut dorf'>&nbsp;"+groupWahlCache[A+"|"+z]+(P>0?"<span style='color:red;position:absolute;right:30px;font-weight:bold;'>&gt;"+P+"</span>":"")+(ak>0?"<span style='color:blue;position:absolute;right:3px;font-weight:bold;'>&gt;"+ak+"</span>":"")+(al>0?"<span style='position:absolute;left:324px;padding:0 1px;top:0px;"+(showWerSchafftsX!=null?(v?(ad?"background:orange;":"background:green;"):"background:red;"):"")+"' onmouseover='Tip(\""+(al>0?L.rapid_onlinetimes_yes+" ( <strong>"+al+" h</strong> )":L.rapid_onlinetimes_no)+"\");'><img src='"+PLAN_BASE_DIR+"img/silk/time.png' /></span>":"")+"</div>")}}if(am==0){Y.push(L.groupCitys_noFound)}l=Y.join("");var C="";rapidModeSelectedZielDorfArray=[];checkTime(X,"FeindWahl-Beg");for(var ai=0;ai<rapidModeFeindListe.length;ai++){var E=rapidModeFeindListe[ai];var ag=getPlayersCitys(E,rapidModeRefresh);C+="<table class='emu-cs0 emu-cp0' style='margin-top:8px;'><tr><td valign=top><div style='width:80px;margin:3px;margin-left:8px;font-size:14px;font-weight:bold;'>"+getTribeIMGForPlayer(E)+"<strong>"+E+"</strong></div>";for(var af=0;af<ag.length;af++){var A=ag[af][0];var z=ag[af][1];var a=0;var s=0;if(g[A]!=null){if(g[A][z]!=null){a=g[A][z][U];s=g[A][z][T]}}var O=false;var I="";if(rapidModeSelectedZielDorf!=null&&rapidModeSelectedZielDorf[getTravKoords(A,z)]>=1){O=true;I=types[rapidModeSelectedZielDorf[getTravKoords(A,z)]][1]}if(O){rapidModeSelectedZielDorfArray[rapidModeSelectedZielDorfArray.length]=[A,z]}var c=null;var K="";var J="";var N="red";var w=false;var H=0;if(rapidModeShowLaufzeiten){if(rapidModeSelectedStartDorfLastSelected!=null){var D=rapidModeSelectedStartDorfLastSelected[0];var B=rapidModeSelectedStartDorfLastSelected[1];var h=getToolUserId(D,B);c=getLaufzeitTP(D,B,A,z,rapidModeSpeed,getTP(D,B));if(getIsOnline(h,rapidModeAnkunftZeit-c,"rapidModeRefresh();")){w=true}if(!w&&rapidModeAnkunftZeitTolerant>0){for(var f=1;f<=rapidModeAnkunftZeitTolerant;f++){if(getIsOnline(h,rapidModeAnkunftZeit-c+(f*60*60),"rapidModeRefresh();")){w=true;H=f;break}if(getIsOnline(h,rapidModeAnkunftZeit-c-(f*60*60),"rapidModeRefresh();")){w=true;H=(-f);break}}}var k=getZeitZeitDatum(rapidModeAnkunftZeit-c+H*60*60);var Z="(Abs.:) ";if(H!=0){Z="(T:"+(H>=0?"+":"")+H+"h) "}K=Z+k[0];J=k[1];if(w){if(H==0){N="green"}else{N="#6F9500"}}c=getTimeString(c)}else{c=L.rapid_runtime_noStart}}var b=230+20;if(c!=null){b=490+20}C+="<div id='rModDorf"+A+"x"+z+"' onclick='rapidModeSelectZielDorf("+A+","+z+");'  style='fl2oat:left;position:relative;width:"+b+"px;padding:1px 4px;position:relative;"+(O?"background:"+I+";color:white;":"")+"'  class='goldbutWithBut dorf "+(O?"dorfsel":"")+"'>&nbsp;<span style='position:absolute;left:60px;' class=c>"+crop(getCityName(A,z),10)+"</span><span style='position:absolute;left:147px;'>"+getCityEW(A,z)+" "+(site_lang=="de"?"EW":"Pop")+"</span>"+(c!=null?"<span style='position:absolute;right:215px;' class=lz>"+c+"</span><span style='position:absolute;right:113px;color:"+N+";'>"+K+"</span><span style='position:absolute;right:55px;color:"+N+";'>"+J+"</span>":"")+"<span style='position:absolute;left:0px;width:30px;text-align:right;'>"+A+"</span><span style='position:absolute;left:30px;text-align:left;'>|"+z+"</span>"+(a>0?"<span style='color:red;position:absolute;right:50px;font-weight:bold;'>&lt;"+a+"</span>":"")+(s>0?"<span style='color:blue;position:absolute;right:23px;font-weight:bold;'>&lt;"+s+"</span>":"")+"<span style='position:absolute;right:0px;te2xt-align:left;cursor:pointer;"+(showWerSchafftsX==A&&showWerSchafftsY==z?"background:purple;":"")+"' onmouseover='Tip(\""+L.rapid_runtime_toolHelp+" \");' onclick='rapidModeSelectZielDorf("+A+","+z+");rapidModeShowWerSchaffts("+A+","+z+");return false;'><img src='"+PLAN_BASE_DIR+"img/silk/time.png' /></span></div>"}C+="<br style='clear:left' /></td></tr></table>"}if(rapidModeFeindListe.length==0){C+=L.rapid_enemys_noEntrys}var d="";checkTime(X,"HTML-Bau");M+="<h2>Rapid-Modus</h2><div class='absatzBack'>  <span style='font-weight:bold;color:blue;' title='"+L.rapid_tip1_text+"' onmouseover='ToolTip.mouseover(this);' >"+L.rapid_tip1_name+"</span> | <span style='font-weight:bold;color:blue;' title='"+L.rapid_tip2_text+"' onmouseover='ToolTip.mouseover(this);'>"+L.rapid_tip2_name+"</span> | <span style='font-weight:bold;color:blue;' title='"+L.rapid_tip3_text+"' onmouseover='ToolTip.mouseover(this);'>"+L.rapid_tip3_name+"</span> &nbsp; <br /><br /><table><tr><td valign=top>&nbsp; &nbsp; <strong>"+L.rapid_form_attack+"</strong><div style='border:1px outset #DDD;background:#DDD;width:380px;padding:5px;background-image:url(img/back-paper4.png);'><table><tr><td>"+L.rapid_form_rapMod+":</td><td>"+getButton(L.rapid_mode_attack,false,"rapidModeSetModus(0);",{small:1,"class":(rapidModeModus==0?"sbsel":"")})+" &nbsp "+getButton(L.rapid_mode_conquor,false,"rapidModeSetModus(1);",{small:1,"class":(rapidModeModus==1?"sbsel":"")})+"</td></tr><tr><td>"+L.rapid_form_arrival+":</td><td><input type=text value='"+x+"' onchange='rapidModeSetAnkunftZeit(this.value);' /> (in ca. "+(Math.round((rapidModeAnkunftZeit-getCurrentUnixTime())/60/60))+" Std.)</td></tr><tr><td> &bull; "+L.rapid_form_arrivalThr+":</td><td><input type=text value='"+rapidModeAnkunftZeitTolerant+"' onchange='rapidModeSetZeitToleranz(this.value);' size=2 /> "+L.rapid_form_arrivalThrHrs+"  <span style='color:blue;font-weight:bold;' onmouseover='Tip(\""+L.rapid_form_arrivalThrHelp+" \", WIDTH, 300);'>(?)</span></td></tr>"+(rapidModeModus==0?"<tr><td>"+L.rapid_form_asInput+":</td><td valign=bottom>"+L.rapid_form_modNormal+"</td></tr>":"<tr><td>"+L.rapid_form_asInput+":</td><td valign=bottom>"+L.rapid_form_modAdel+"</td></tr>")+(rapidModeModus==1?"<tr><td >"+L.rapid_form_pre1+":</td><td valign=bottom>"+L.rapid_form_pre1t+" <span class='gray'>(Speed 3)</span></td></tr><tr><td >"+L.rapid_form_pre2+":</td><td valign=bottom>"+L.rapid_form_pre2t+" <span class='gray'>(Speed 4)</span></td></tr><tr><td >"+L.rapid_form_pre3+":</td><td valign=bottom>"+L.rapid_form_pre3t+" <span class='gray'>(Speed 4)</span></td></tr>":"")+"<tr><td >"+L.rapid_form_typFirst+":</td><td valign=bottom><table class='emu-cs0 emu-cp0'><tr><td><div class='clickable'><div onclick='openTypPopup(0,\"rapidModeTypDiv\","+rapidModeTyp+",\"rapidModeSetTyp\");' style='color:"+types[rapidModeTyp][1]+"'>"+types[rapidModeTyp][0]+"</div></div></td><td class='gray'>("+L.rapid_form_typFirst+")</td></tr></table></td></tr><tr><td >"+L.rapid_form_typSecond+":</td><td valign=bottom><table class='emu-cs0 emu-cp0'><tr><td><div class='clickable'><div onclick='openTypPopup(0,\"rapidModeTypDiv2\","+rapidModeTyp2+",\"rapidModeSetTyp2\");' style='color:"+types[rapidModeTyp2][1]+"'>"+types[rapidModeTyp2][0]+"</div></div></td><td class='gray'>("+L.rapid_form_typSecond_help+")</td></tr></table></td></tr>"+(rapidModeModus==0?"<tr><td>"+L.rapid_form_speed+":</td><td><div class='clickable' style='width:85px;'><div onclick='openSpeedPopup(0,\"rapidModeSpeedDiv\","+rapidModeSpeed+',"rapidModeSetSpeed");\'>'+(getSpeedPicsHTML(0,rapidModeSpeed))+"&nbsp;<strong>"+rapidModeSpeed+"</strong></div></div></td></tr><tr><td>"+L.rapid_form_waves+":</td><td><input style='width:30px;text-align:center;' type=text value='"+rapidModeWellen+"' onchange='rapidModeSetWellen(this.value);' /></td></tr>":"")+"</table></div></td><td width=20 style='padding:8px;'></td><td valign=top>&nbsp; &nbsp; <strong>"+L.rapid_form_enemys+"</strong><div style='border:1px outset #DDD;background:#DDD;width:400px;padding:5px;background-image:url(img/back-paper4.png);'>"+G+"</div></td></tr></table><br /><table><tr><td valign=top><div style='font-weight:Bold;'>&nbsp; &nbsp; "+L.rapid_form_starts+" "+("&nbsp;("+L.plantab_filterung+":"+(rapidModeShowAllGroupCitys==0?"<strong>"+L.rapid_form_start_fAll+"</strong>":"<a onclick='rapidModeShowAllGroupCitysToogle(0);'>"+L.rapid_form_start_fAll+"</a>")+", "+(rapidModeShowAllGroupCitys==1?"<strong>"+L.rapid_form_start_fOff+"</strong>":"<a onclick='rapidModeShowAllGroupCitysToogle(1);'>"+L.rapid_form_start_fOff+"</a>")+", "+(rapidModeShowAllGroupCitys==2?"<strong>"+L.rapid_form_start_fOffCon+"</strong>":"<a onclick='rapidModeShowAllGroupCitysToogle(2);'>"+L.rapid_form_start_fOffCon+"</a>")+", "+(rapidModeShowAllGroupCitys==3?"<strong><u><a onclick='rapidModeShowAllGroupCitysToogle(3);'>"+L.rapid_form_start_fSpez+"</a></u></strong>":"<a onclick='rapidModeShowAllGroupCitysToogle(3);'>"+L.rapid_form_start_fSpez+"</a>")+")")+"</div><div style='border:1px outset #DDD;background:#DDD;padding:5px;width:418px;max-height:600px;overflow:auto;' id='rapidStartWahl'>"+l+"</div></td><td width=20 style='padding:8px;'><img src='img/pfeil_lang_14.png' /></td><td valign=top><div style='font-weight:Bold;'>&nbsp; &nbsp; "+L.rapid_form_targets+": </div><div style='border:1px outset #DDD;background:#DDD;width:570px;padding:5px;max-height:600px;overflow:auto;' id='rapidFeindWahl'>"+C+"</div></td></tr></table><table style='margin-top:10px;width:100%;'><tr><td><div></div></td><td>"+getButton(L.rapid_close,"cross","rapidModeHide();")+"</td><td>"+getButton(L.rapid_copy_clipboard,"add","rapidModeAddEntry(0);")+"</td><td>"+getButton(L.rapid_copy_plan,"add","rapidModeAddEntry(1);")+"</td></tr></table></div>";checkTime(X,"HTML-Bau Ende");var r=0;var m=0;if(dge("rapidStartWahl")){m=dge("rapidStartWahl").scrollTop}if(dge("rapidFeindWahl")){r=dge("rapidFeindWahl").scrollTop}ab.innerHTML=M;if(m>0){if(dge("rapidStartWahl")){dge("rapidStartWahl").scrollTop=m}}if(r>0){if(dge("rapidFeindWahl")){dge("rapidFeindWahl").scrollTop=r}}checkTime(X,"Rapid-Mode Ende");checkTimeShowTimes(X)}function clickDorfButSuch(){var a=dge("dorfButXY");if(a!=null&&openDorfBut!=null){setXYDorfBut(a.value)}}function setXYDorfBut(c){if(openDorfBut!=null){if(c.indexOf("|")==-1&&c.indexOf(",")==-1){return alert("Ungültige Koordinaten.")}var b;if(c.indexOf("|")!=-1){b=c.split("|")}else{b=c.split(",")}var a=b[0];var d=b[1];if(!isFinite(a)||!isFinite(d)||a==null||d==null){return alert("Ungültige Koordinaten.")}openDorfBut[3]=a;openDorfBut[4]=d;openDorfBut[5]=null;refreshDorfBut()}}function refreshDorfBut(){setTimeout("clickDorfBut();",1)}function okDorfBut(){if(openDorfBut!=null){var d=openDorfBut[1];var c=openDorfBut[2];var a=openDorfBut[3];var f=openDorfBut[4];var b=getLineByLineId(d);if(c==0){b[1]=a;b[2]=f;b[PD_FORTOOLUSERID]=getToolUserId(a,f)}if(c==1){b[3]=a;b[4]=f}setModified(d);Popup.close();refreshPlan();Wizard.checkNext()}}function dorfButSetSuchSpieler(){var b=dge("dorfButSuchSpieler");if(b!=null&&openDorfBut!=null){var a=b.value;openDorfBut[5]=a;refreshDorfBut()}return false}var openDorfBut=null;function clickDorfBut(f,g){var b=false;if(f==null){b=true;if(openDorfBut!=null){f=openDorfBut[1];g=openDorfBut[2]}else{return}}else{Popup.close()}if(openDorfBut==null){openDorfBut=[0,f,g,null,null,null]}var m="";var n=openDorfBut[3];var l=openDorfBut[4];if(n==null&&l==null){var p=getLineByLineId(f);if(g==0){n=p[1];l=p[2]}if(g==1){n=p[3];l=p[4]}}var d=openDorfBut[5];if(d==null){d=getSpielerName(n,l,refreshDorfBut)}openDorfBut=[0,f,g,n,l,d];m=g==0?L.cityPop_title_start:L.cityPop_title_target;var a=getPlayersCitys(d,refreshDorfBut);citys_from_player=buildDorfSelectBox(a,L.cityPop_list_actual+" "+d+"",g);var a=getPlayersCitysFromPlan(g);var c=buildDorfSelectBox(a,(g==0?L.cityPop_list_startCitys:L.cityPop_list_targetCitys),g);if(g==0){var o=buildDorfSelectBox(gmc,L.cityPop_list_offCitys,g,2)}if(g==0){var k=buildDorfSelectBox(gmc,L.cityPop_list_allCitys,g,1)}var h="<div style='width:280px;' class='dorfdiv'><table width=100%><tr><td>"+L.cityPop_coords+":</td><td align=right><form onSubmit='return false;'><input onchange='if (isValidKoordWithKomma(dge(\"dorfButXY\").value)) clickDorfButSuch();'  class=kxy type=text name=x id='dorfButXY' value='"+(n!=null?n+"|"+l:"|")+"' />&nbsp;<input class='kxybut'  onclick='if (isValidKoordWithKomma(dge(\"dorfButXY\").value))okDorfBut();else alert(\"Ungültige Koords.\\nInvalid input.\");'  style='display:none' type=submit name=send value='"+L.dialog_ok+"'></form></td></tr><tr><td colspan=2 style='padding:0px;height:2px;background:black;'></td></tr><tr><td>"+L.cityPop_cityName+":</td><td>"+getCityName(n,l,refreshDorfBut)+"</td></tr><tr><td>"+L.cityPop_player+":</td><td>"+getSpielerName(n,l,refreshDorfBut)+"</td></tr><tr><td colspan=2 style='padding:0px;height:2px;background:black;'></td></tr><tr><td colspan=2 style='padding-top:4px;font-weight:bold;font-size:110%;'>"+L.cityPop_quickList+":</td></tr><tr><td>"+L.cityPop_searchCitys+":</td><td align=right><form onsubmit='return false; '><input onclick='this.value=\"\";' style='width:90px' value='"+d+"' id='dorfButSuchSpieler' />"+getButton("","magnifier","dorfButSetSuchSpieler();",{small:1})+"</form></td></tr><tr><td colspan=2>"+citys_from_player+"</td></tr><tr><td colspan=2>"+c+"</td></tr>"+(g==0?"<tr><td colspan=2>"+o+"</td></tr>":"")+(g==0?"<tr><td colspan=2>"+k+"</td></tr>":"")+"</table><table width=100% style='margin-top:8px;'><tr><td align=center>"+getButton(L.dialog_ok,"tick","okDorfBut();")+"</td><td align=center>"+getButton(L.dialog_abort,"cross","Popup.close();")+"</td></tr></table></div>";if(b){dge("dorfButDiv").innerHTML=h}else{Popup.open(m,"<div id='dorfButDiv'>"+h+"</div>","dorf")}dge("dorfButXY").focus();dge("dorfButXY").select();return}function getDorfBut(a,d,c,b){return"<div id='dd"+c+"_"+b+"' class='dorfdiv dorf clickable' style='width:178px;'><table onclick='clickDorfBut("+c+","+b+");' class='emu-cs0 '><tr><td align=center class=x><div>"+(a!=null?a+"</div></td><td class=m>|</td><td class=y><div>"+d:"<div style='width:58px;text-align:center;'></div>")+"</div></td><td class=c><div style='position:relative;width:120px;'>"+(a!=null?"<span class=c>"+crop(getCityName(a,d),10)+" </span><span style='position:absolute;right:3px;top:0px;'>(<span class=s>"+getSpielerName(a,d)+"</span>)</div>":"<span class=dw>"+L.cityPop_clickToChoose+"</span></span>")+"</td></tr></table></div>"}function buildDorfSelectBox(v,p,J,d,o){if(o==null){o="setXYDorfBut"}var s="<select onchange='"+o+"(this.value);' style='font-family:Courier; width:100%;background:white;border:1px inset black;'><option value=''>"+p+"</option>";tableheadline=(site_lang=="de"?"Koords______Dorf__________EW___Spieler_________":"Koords______Village_______Pop__Player__________");if(J==0){tableheadline+=(site_lang=="de"?"TP_____Off___Adel_KP?__":"TS_____Off___Conq_CP?__")}if(J==1){tableheadline+="___"}if(d==null||d==1||d==2){tableheadline+=(site_lang=="de"?"___Laufzeit___Absendende-Zeit______"+(J==1?"Start-Spieler ":"")+"Online?":"___Traveltime_Send-time____________"+(J==1?"Start Player__":"")+"Online?")}var c=null;if(d==null||d==1||d==2){if(openDorfBut!=null){var C=getLineByLineId(openDorfBut[1]);var l=C[PD_FROMX];var h=C[PD_FROMY];var G=C[PD_TOX];var E=C[PD_TOY];var x=C[PD_SPEED];var k=C[PD_DESTTIME];var u=C[PD_FORTOOLUSERID]}}s+="<option disabled style='font-weight:bold;color:black;'>"+tableheadline+"</option>";for(var w=0;w<v.length;w++){var g=v[w][0];var f=v[w][1];if(d==2){var b=getCityFlag(g,f);if(b!=2&&b!=3){continue}}var B="";var n=getSpielerName(g,f);var c=null;if(J==0){l=g;h=f;var c=getTP(g,f);var H=getOffInK(g,f);B=""+c+(c<10?"_":"")+""+getMultiChar("_",8-(H+"").length)+H;var A=getAdel(g,f);var r=getGenugKP(g,f);if(A>0){B+="___"+A}else{B+="___-"}B+="____";if(r==0){B+=(site_lang=="de"?"Nein":"No__")}else{if(r==1){B+=(site_lang=="de"?"Ja__":"Yes_")}else{B+="-___"}}}else{if(J==1){G=g;E=f;if(c===null){c=getTP(l,h)}}}if(l!=null&&G!=null){var q=getLaufzeitTP(l,h,G,E,x,c);var I=getTimeInCountdownFormat(q);var D=k-q;var z=getZeitZeitDatum(D);var m=z[0]+"__"+z[1];B+=getMultiChar("_",11-(""+I).length)+"_"+I;B+="___"+m;if(getIsOnline(u,D)){B+="___Online"}else{B+="_________"}}else{var I="-";B+="______"+I}var y=g+"|"+f;var a=crop(getCityName(g,f),12);var n=crop(n,14);var F=getCityEW(g,f);s+="<option value='"+y+"'>"+getMultiChar("_",4-(g+"").length)+"("+y+")"+getMultiChar("_",5-(f+"").length)+a+getMultiChar("_",14-a.length)+F+getMultiChar("_",5-(F+"").length)+n+getMultiChar("_",16-(n+"").length)+B+"</option>"}s+="</select>";return s}function markedOptionsSmallToogle(){if(markedOptionsIsSmall){markedOptionsIsSmall=false}else{markedOptionsIsSmall=true}updateMarkedOptions()}var planLinesSelectedCountCache=0;function updateMarkedOptions(){if(markedOptionsDiv==null){markedOptionsDiv=document.createElement("div");markedOptionsDiv.style.position="fixed";markedOptionsDiv.style.left="120px";markedOptionsDiv.style.top="160px";markedOptionsDiv.style.width="200px;";markedOptionsDiv.style.zIndex=100;document.body.appendChild(markedOptionsDiv)}var d="";var f=0;if(planLinesSelectedCountCache>0||planLinesSelectedMustRecountedFlag){planLinesSelectedMustRecountedFlag=false;for(var b=0;b<allPlans.length;b++){for(var c=0;c<allPlans[b].length;c++){var a=allPlans[b][c];var g=a[0];if(planLinesSelected[g]===true){f++}}}if(f==0){planLinesSelected=[]}}planLinesSelectedCountCache=f;if(f==0){markedOptionsDiv.style.display="none";markedOptionsIsSmall=true;selectionFakeGenXY=null}else{if(selectionFakeGenXY==null){selectionFakeGenXY=[lastSelectedToDorfXY[0],lastSelectedToDorfXY[1]]}if(markedOptionsIsSmall){d="<div style='border:4px inset white;width:274px;z-index:98;'><div style='background:#EEE;border:2px outset #EEE;width:270px;' ><div class=goldbutWithBut style='background:blue;font-size:16px;padding:2px 10px;font-weight:bold;color:white;' onclick='markedOptionsSmallToogle();'>Selektions-Optionen</div></div></div>"}else{d="<div style='background:#EEE;border:2px outset #EEE;width:270px;' ><div onclick='markedOptionsSmallToogle();' style='background:blue;font-size:16px;padding:2px 10px;font-weight:bold;color:white;'>Selektions-Optionen <a style='font-size:12px;color:white;'>(verkleinern)</a></div><div style='padding:8px'><div style='margin:5px 0px;'>Es wurden <strong> "+f+" </strong> Zeilen selektiert.<br />Tip: SHIFT (de-)selektiert mehrere. (<a onmouseover='Tip(\"Erst die erste gewünschte Zeile <strong>ohne SHIFT </strong> (de-)selektieren, danach die letzte Zeile <strong>mit SHIFT </strong> anklicken. <br />Nun sind alle Zeilen dazwischen auch (de-)selektiert. \", WIDTH,280)'>Wie?</a>)</div><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:5px;color:red;' onclick='selectedLineDelete();'>Löschen</div><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:5px;' onclick='selectedLineDuplicate();'>Duplizieren (->Ablage)</div><div style='margin-top:16px;font-size:14px;text-decoration:underline;font-weight:bold;margin-bottom:3px;'>Zeitverschiebungs-Tool:</div><strong>um </strong> <input onchange='changeZeitMove();' type=text id='zeitMoveD' size=1 value='"+(zeitMoveD)+"' />Tage und <input onchange='changeZeitMove();' type=text id='zeitMoveH' size=1 value='"+(zeitMoveH)+"' />h <input onchange='changeZeitMove();' type=text id='zeitMoveM' size=1 value='"+(zeitMoveM)+"' />m <input onchange='changeZeitMove();' type=text id='zeitMoveS' size=1 value='"+(zeitMoveS)+"' />s<table class='emu-cs0 emu-cp0' style='width:100%;'><tr><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:5px;' onclick='selectedLineTimeMove(false);'>Früher</div></td><td><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:5px;' onclick='selectedLineTimeMove(true);'>Später</div></td></tr></table><div style='margin-top:16px;font-size:14px;text-decoration:underline;font-weight:bold;margin-bottom:3px;'>Perfekte-Fakes-Generator:</div>&nbsp; Angriffe identisch faken auf <input onchange='changeFakeGenXY();' size=5 type=text id='fakeGenXY'><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:5px;' onclick='selectedLineFakeGenerator();'>Gib mir die Fakes</div><div class=goldbutWithBut style='text-align:center;padding:4px;font-weight:bold;margin-top:20px;' onclick='selectedLineDeselectAll();'>Selektion aufheben</div></div></div>"}markedOptionsDiv.innerHTML=d;markedOptionsDiv.style.display="block"}}function testMarked(){planMarkLine(pdata[0][0]);planMarkLine(pdata[1][0]);planMarkLine(pdata[2][0])}var selectionFakeGenXY=null;function changeFakeGenXY(){if(dge("fakeGenXY")==null){return alert("Das is doch voll blöd.")}var b=dge("fakeGenXY").value;if(isValidKoord(b)){var c=b.split("|");var a=c[0];var d=c[1];selectionFakeGenXY=[a,d];updateMarkedOptions()}else{alert("Ungültige Koordinaten")}}function setSelectionFakeGenXY(a,b){if(!isFinite(a)||!isFinite(b)){return alert("Ganz komische Sachen!")}selectionFakeGenXY=[a,b];updateMarkedOptions()}var zeitMoveD,zeitMoveH,zeitMoveM,zeitMoveS;function changeZeitMove(){if(dge("zeitMoveD")==null||dge("zeitMoveH")==null||dge("zeitMoveM")==null||dge("zeitMoveS")==null){return alert("Das is doch voll blöd.")}zeitMoveD=parseInt(dge("zeitMoveD").value);zeitMoveH=parseInt(dge("zeitMoveH").value);zeitMoveM=parseInt(dge("zeitMoveM").value);zeitMoveS=parseInt(dge("zeitMoveS").value);if(!isFinite(zeitMoveD)){zeitMoveD=0}if(!isFinite(zeitMoveH)){zeitMoveH=0}if(!isFinite(zeitMoveM)){zeitMoveM=0}if(!isFinite(zeitMoveS)){zeitMoveS=0}}function getSelectedLinesArray(){var f=[];for(var b=0;b<allPlans.length;b++){for(var c=0;c<allPlans[b].length;c++){var a=allPlans[b][c];var d=a[0];if(planLinesSelected[d]===true){f[f.length]=d}}}return f}function selectedLineDelete(){var a=getSelectedLinesArray();for(var b=0;b<a.length;b++){flushPlanLineCache(a[b]);delRow(a[b],true)}planLinesSelected=[];refreshPlan()}function selectedLineFakeGenerator(){var g=getSelectedLinesArray();for(var f=0;f<g.length;f++){flushPlanLineCache(g[f]);var b=copyRow(g[f],true);var c=getLineByLineId(b);var d=c[PD_ART];c[PD_TOX]=selectionFakeGenXY[0];c[PD_TOY]=selectionFakeGenXY[1];var a=d;a=getFakeTypFromNormalTyp(d);c[PD_ART]=a}refreshPlan()}function getFakeTypFromNormalTyp(b){var a=b;if(b==1){a=10}if(b==2){a=11}if(b==3){a=11}if(b==4){a=12}if(b==30){a=31}return a}function selectedLineDuplicate(){var b=getSelectedLinesArray();for(var a=0;a<b.length;a++){flushPlanLineCache(b[a]);copyRow(b[a],true)}planLinesSelected=[];refreshPlan()}function selectedLineDeselectAll(){var b=getSelectedLinesArray();for(var a=0;a<b.length;a++){flushPlanLineCache(b[a])}planLinesSelected=[];refreshPlan()}function selectedLineTimeMove(d){var f=getSelectedLinesArray();var b=0+(zeitMoveD*24*60*60)+(zeitMoveH*60*60)+(zeitMoveM*60)+(zeitMoveS);if(!d){b=-b}for(var c=0;c<f.length;c++){flushPlanLineCache(f[c]);var a=getLineByLineId(f[c]);a[8]+=b}refreshPlan()}var lastSelectedToDorfXY=[0,0];function planMarkLine(d){planLinesSelectedMustRecountedFlag=true;if(isShiftPressed&&lastMarkedLineId!=null&&d!=lastMarkedLineId){var m=0;var b=0;var k=-1;var f=-1;var c=getPDataLineId(d);var h=getPDataLineId(lastMarkedLineId);if(c!==h){return alert("Nicht erlaubte Markierung!")}for(var g=0;g<c.length;g++){if(c[g][0]==d){k=g}if(c[g][0]==lastMarkedLineId){f=g}}if(k==-1||f==-1){return alert("Bereich konnte nicht bestimmt werden! ("+k+"-"+f+") ")}if(k>f){m=f+1;b=k}else{m=k;b=f-1}for(var g=m;g<=b;g++){var a=c[g][0];planLinesSelected[a]=planLinesSelected[a]!==true;flushPlanLineCache(a)}refreshPlan()}else{planLinesSelected[d]=planLinesSelected[d]!==true;flushPlanLineCache(d);var n=getLineByLineId(d);lastSelectedToDorfXY=[n[PD_TOX],n[PD_TOY]];var l=dge("selImg"+d);if(l==null){return alert("Da stimmt was nicht!")}l.src=planLinesSelected[d]?"img/kreis_sel.png":"img/kreis.png";updateMarkedOptions()}lastMarkedLineId=d}var TEST_RAPID_MODE=false;try{var PLAN_BASE_DIR="";if(typeof BASE_DIR!="undefined"){PLAN_BASE_DIR=BASE_DIR}var TESTTIME=false;var ppool=[];var pdata=[];var pdata_temp=[];var types=[];var types_index=[];var tps=[];var PD_LINEID=0;var PD_FROMX=1;var PD_FROMY=2;var PD_TOX=3;var PD_TOY=4;var PD_ART=5;var PD_SPEED=6;var PD_STARTTIME=7;var PD_DESTTIME=8;var PD_WELLEN=9;var PD_TARGET_ORDER=10;var PD_STATUS=11;var PD_COMMENT_ID=12;var PD_COMMENT=13;var PD_DELETED=14;var PD_FORTOOLUSERID=15;var PD_SPEEDMOD=16;function setSpeed(b,a){return setLData(b,6,a)}function setSpeedMod(b,a){return setLData(b,PD_SPEEDMOD,a)}function changeTyp(b,a){return setLData(b,5,a)}function changeWellen(b,a){return setLData(b,9,a)}function setLData(d,b,c){var a=getLineByLineId(d);a[b]=c;setModified(d);refreshPlan();Wizard.checkNext()}function changeDestTime(b,a){return changeStartTime(b,a,1)}function changeStartTime(g,f,d){var c=getUnixTime(f);if(c==-1){refreshPlan();alertTimeParsingFailed();return false}var a=getLineByLineId(g);var b=a[8]-a[7];if(d){a[8]=c;a[7]=a[8]-b}else{a[7]=c;a[8]=a[7]+b}setModified(g);refreshPlan()}var Wizard={queue:[],abort:function(){Wizard.queue=[]},checkNext:function(){if(Wizard.queue.length>0){Popup.mouse[1]=$("#plantable1").offset().top;setTimeout("eval(Wizard.queue.shift());",1)}}};var Popup={mouse:[0,0],popup:null,type:"",open:function(f,c,b){Popup.type=b;if(!Popup.popup){Popup.popup=document.createElement("div");document.body.appendChild(Popup.popup);Popup.popup.style.position="absolute";Popup.popup.style.left="0";Popup.popup.style.top="0";Popup.popup.style.zIndex="10000"}var d=Math.max(50,Popup.mouse[1]-200);Popup.popup.style.left=Popup.mouse[0]+"px";Popup.popup.style.top=d+"px";var a="";a+="<h2>"+f+"</h2>";a+="<div class='absatzBack'>"+c+"</div>";Popup.popup.innerHTML=a;$(Popup.popup).show("")},close:function(){if(Popup.popup){$(Popup.popup).hide();Popup.popup.innerHTML=""}},getMouseXY:function(a){Popup.mouse=(document.all)?[event.clientX*1+document.body.scrollLeft*1,event.clientY*1+document.body.scrollTop*1]:[a.pageX*1,a.pageY*1];return true}};document.onmousemove=Popup.getMouseXY;function getSilkIcon(c){var a=BASE_DIR+"img/silk/"+c+".png";var b="";return"<img class='abs' style='"+b+"' src='"+a+"' width='16' height='16' />"}function getButton(d,c,b,a){if(c){d=getSilkIcon(c)+" <span class='abs'>"+d+"</span>"}return"<button class='stylebutton"+(a&&a.cssclass?" "+a.cssclass+"":"")+(a&&a.small?" stylebuttonsmall":"")+"'  style='"+(a?a.style:"")+"'  type='submit' onclick='"+b+"' >"+d+"</button>"}function openTypPopup(g,h,c,b){b=b||"changeTyp";h=h||"tp"+g;if(c==null){var a=getLineByLineId(g);c=a[5]}var f=[[1,10],[2,0],[3,11],[4,12],0,[5,0],0,[20,0],0,[30,31],[32,0],];var d="";$.each(f,function(l,k){var m=k[0];d+="<div style='width:200px;overflow:hidden;'>";if(k==0){d+="<div style='height:6px;'></div>"}else{$.each(k,function(n,o){d+="<div style='float:left;width:100px;'>";if(types[o]){var p=c==o;d+=getButton(types[o][0],false,b+"("+g+","+o+");Popup.close();",{style:"color:"+types[o][1]+";width:94px;display:block;margin:2px 3px;",small:1,cssclass:(p?"sbsel":"")})}d+="</div>"})}d+="</div>"});d+=getButton(L.dialog_abort,"cross","Popup.close();Wizard.abort();",{style:"display:block;width:120px;margin:8px auto 0;"});Popup.open(L.dialogType_title,d,"type");return}function openSpeedPopup(h,o,a,g){var d=0;g=g||"setSpeed";o=o||"sp"+h;var c=100;if(a==null){var q=getLineByLineId(h);a=q[6];c=q[PD_SPEEDMOD];d=getSpielerTribeId(q[1],q[2])}if(!c){c=100}var k=90;if(g!="setSpeed"){k=150}var n="";n+="<div style='overflow:hidden;width:210px;'>";n+="<div style='float:left;width:"+(k+20)+"px;'>";for(var m=0;m<speeds[d].length;m++){var f=speeds[d][m][1];var b=f==a;var l=(d>0?"<img align=absmiddle src='img/"+PLAN_UNITS_IMAGE_BASE+(speeds[d][m][0]+1+d*10-10)+"."+PLAN_UNITS_IMAGE_EXT+"' />":getSpeedPicsHTML(d,f));n+=getButton(l+" <strong>"+f+"</strong>",false,g+"("+h+","+f+");Popup.close();",{style:"width:"+k+"px;display:block;margin:2px;",small:1,cssclass:(b?"sbsel":"")})}n+="</div>";if(g=="setSpeed"){n+="<div style='float:left;width:90px;'>";for(var m=0;m<4;m++){var p=(100+m*25);var b=p==c;var l="<img align=absmiddle src='img/hero.gif' />";n+=getButton(l+" <strong>+"+(p-100)+"%</strong>",false,"setSpeedMod("+h+","+p+");Popup.close();",{style:"width:80px;display:block;margin:2px;",small:1,cssclass:(b?"sbsel":"")})}n+="</div>"}n+="</div>";n+=getButton(L.dialog_abort,"cross","Popup.close();Wizard.abort();",{style:"display:block;width:120px;margin:8px auto 0;"});Popup.open(L.dialogSpeed_title,n,"speed");return}function closePopups(){Popup.close()}function gl_refreshPlan(){refreshPlan()}var line_pool=[];var line_cache=[];var comparePlanIndex=7;function compareLines(d,c){var g=0;if(comparePlanIndex=="laufzeit"){g=(d[8]-d[7])-(c[8]-c[7])}else{if(comparePlanIndex=="start"){g=(d[1]*1000+d[2])-(c[1]*1000+c[2])}else{if(comparePlanIndex=="ziel"){g=(d[3]*1000+d[4])-(c[3]*1000+c[4])}else{if(comparePlanIndex=="startSpieler"){var h=getSpielerName(d[1],d[2]);var f=getSpielerName(c[1],c[2]);if(h<f){g=-1}else{if(h>f){g=+1}else{g=0}}}else{if(comparePlanIndex=="zielSpieler"){var h=getSpielerName(d[3],d[4]);var f=getSpielerName(c[3],c[4]);if(h<f){g=-1}else{if(h>f){g=+1}else{g=0}}}else{g=d[comparePlanIndex]-c[comparePlanIndex]}}}}}if(g==0){g=(d[7]-c[7])}if(g==0){g=(d[8]-c[8])}return g}function sortBySpalte(a){comparePlanIndex=a;pdata.sort(compareLines);pdata_temp.sort(compareLines);refreshPlan()}function getSortLink(b,a){return"<a onclick='sortBySpalte("+(isFinite(b)?"":'"')+b+(isFinite(b)?"":'"')+");' style='"+(comparePlanIndex==b?"text-decoration:underline;":"")+"'>"+a+"</a>"}function getKeyCode(a){a=a||window.event;return a.keyCode}var isStrgPressed=false;var isAltPressed=false;var isShiftPressed=false;var showPressedDiv=null;function showPressed(){if(site_lang!="de"){return}if(showPressedDiv==null){showPressedDiv=document.createElement("div");showPressedDiv.style.position="absolute";showPressedDiv.style.left="50%";showPressedDiv.style.top="130px";showPressedDiv.style.width="200px;";showPressedDiv.style.marginLeft="-100px";showPressedDiv.style.textAlign="center";showPressedDiv.style.zIndex=100;document.body.appendChild(showPressedDiv)}if(!isStrgPressed&&!isShiftPressed){showPressedDiv.style.display="none"}else{showPressedDiv.style.display="block";var a="<div style='background:lightblue;padding:5px 12px;border:1px outset lightblue;'><div style='font-weight:bold;font-size:16px;'>";if(isStrgPressed){a+="STRG&nbsp;+ "}if(isShiftPressed){a+="SHIFT&nbsp;+ "}a+="</div>";if(isStrgPressed){a+="<br /><table style='text-align:left'><tr><td width=80><strong>Strg + S</strong></td><td>Speichern</td></tr><tr><td width=80><strong>Strg + R</strong></td><td>Rapid-Modus</td></tr><tr><td width=80><strong>Strg + N</strong></td><td>Neuer Eintrag</td></tr></table>"}a+="</div>";showPressedDiv.innerHTML=a}}var keyCodeA=65;var asciiCodeA="a".charCodeAt(0);var keyCodeN="n".charCodeAt(0)-asciiCodeA+keyCodeA;var keyCodeD="d".charCodeAt(0)-asciiCodeA+keyCodeA;var CRYPT_DEBUG_PW="lea";function windowKeyDown(a){var b=getKeyCode(a);if(b==16){isShiftPressed=true}if(b==18){isAltPressed=true}if(b==17){isStrgPressed=true}showPressed();if(isStrgPressed&&b==82){rapidModeToogle();return false}if(isStrgPressed&&b==keyCodeN){addPlanLine();return false}if(b==48){b+=10}if(isStrgPressed&&isAltPressed&&isShiftPressed&&b==keyCodeD){if(prompt("Bist du's Meister?")==CRYPT_DEBUG_PW){alert("Ich folge deinem Ruf, Meister!");DEBUG_MODE=true}return false}if(isStrgPressed&&b==83){gl_savePlan();return false}}function windowKeyUp(a){var b=getKeyCode(a);if(b==16){isShiftPressed=false}if(b==18){isAltPressed=false}if(b==17){isStrgPressed=false}showPressed()}var inited=false;var allPlans=[];function initPlanEditor(){window.onkeydown=windowKeyDown;window.onkeyup=windowKeyUp;allPlans=[pdata,pdata_temp];saveFormDataInput=dge("save_form_data");saveFormForm=dge("save_form");if(saveFormDataInput==null||saveFormForm==null){return alert("Fehler auf der Seite!")}inited=true}function refreshPlan(){var a=dge("plan");if(a==null){return alert("Seite unvollständig!")}buildPlan(a,pdata,0);if(pdata_temp.length==0){setAblageVisibility(false)}else{setAblageVisibility(true)}var a=dge("plan_temp");if(a==null){return alert("Seite unvollständig!")}buildPlan(a,pdata_temp,1);updateMarkedOptions()}function missingToolUserIDTip(){Tip("Warnung: Unbekanntes Dorf<br><br>Dieses Dorf konnte keinem Spieler deiner Gruppe zugeordnet werden. Es ist daher nicht möglich, diesen Eintrag einem Spieler zuzuordnen. <br><strong>Unbedingt beachten</strong>: Dieser Eintrag wird in <u>jedem </u> Einsatzplan erscheinen.<br><br>Tip: Sobald das Dorf (wieder) in der Gruppe ist, reicht es das Dorf hier einfach nochmal auszuwählen. ",TITLE,"Unbekanntes Dorf",WIDTH,300,CLICKCLOSE,true)}var planTableVisible=[true,true];function planTableVisibleToogle(a){if(planTableVisible[a]){planTableVisible[a]=false}else{planTableVisible[a]=true}if(planTableVisible[a]){dge("plantable"+a).style.display="block"}else{dge("plantable"+a).style.display="none"}}var planPagerPageSize=20;var planPagerPage=[];var planPagerFilterTyp=[];var planPagerFilterSpieler=[];var planPagerFilterZielSpieler=[];function buildPlan(q,s,G){if(!inited){initPlanEditor()}var B=[];B.push("<table border='0' class='plantable emu-cs0 ' id='plantable"+G+"'>");var O="<tr style='font-weight:bold;' class='tablehead i1'><td></td><td class='s1'>"+getSortLink("start",L.tab_start)+" ("+getSortLink("startSpieler",L.tab_player)+")</td><td class='s2'></td><td class='s3'>"+getSortLink("ziel",L.tab_target)+" ("+getSortLink("zielSpieler",L.tab_player)+")</td><td class='s4'>"+getSortLink(5,L.tab_type)+"</td><td class='s5'>"+getSortLink(7,L.tab_sendtime)+"</td><td class='s6'>"+getSortLink(8,L.tab_arrival)+"</td><td class='s7'>"+getSortLink("laufzeit",L.tab_runtime)+"</td><td class='s8'>"+getSortLink(6,L.tab_speed)+"</td><td class='s9'>"+L.tab_waves+"</td><td class='s10' colspan=2>"+L.tab_options+"</td><td class='s11'>"+L.tab_comments+"</td></tr>";var A=B.join("");B=[];j=0;var P=0;var r=0;if(planPagerPage[G]==null){planPagerPage[G]=0}if(planPagerFilterTyp[G]==null){planPagerFilterTyp[G]=-1}if(planPagerFilterSpieler[G]==null){planPagerFilterSpieler[G]=""}if(planPagerFilterZielSpieler[G]==null){planPagerFilterZielSpieler[G]=""}if(Wizard.queue.length==0){lastNewAddedPlanLine=0}var g=[];var z=[];var U=[];var k=[];for(var S=0;S<s.length;S++){if(s[S][14]!=1){r++;var x=s[S];var l=x[0];var f=getSpielerName(x[1],x[2]);if(z[f]==null){z[f]=true;g[g.length]=f}var H=getSpielerName(x[3],x[4]);if(k[H]==null){k[H]=true;U[U.length]=H}if(line_pool[l]==null){line_pool[l]=[s,x];var I=getTP(x[1],x[2]);if(x[5]==5){x[6]=Math.min(x[6],4)}var M=x[5]==5?x[6]/2:x[6];var b=getLaufzeitTP(x[1],x[2],x[3],x[4],M,I,x[16]);x[7]=x[8]-b}var K=false;if(x[1]==null||x[2]==null||x[3]==null||x[4]==null){K=true}if(lastNewAddedPlanLine==l){K=true}if(!K){if(planPagerFilterTyp[G]!=-1){if(x[5]!=planPagerFilterTyp[G]){continue}}if(planPagerFilterSpieler[G]!=""){if(f!=planPagerFilterSpieler[G]){continue}}if(planPagerFilterZielSpieler[G]!=""){if((H)!=(planPagerFilterZielSpieler[G])){continue}}}if(K||(P>=planPagerPageSize*planPagerPage[G]&&P<planPagerPageSize*(planPagerPage[G]+1))){var D="i1";if(j%2==0){D="i2"}j++;if(line_cache[l]==null){var I=getTP(x[1],x[2]);if(x[5]==5){x[6]=Math.min(x[6],4)}var M=x[5]==5?x[6]/2:x[6];var b=getLaufzeitTP(x[1],x[2],x[3],x[4],M,I,x[16]);x[7]=x[8]-b;var v=false;if(x[PD_FORTOOLUSERID]>0){var m=x[PD_FORTOOLUSERID];if(getIsOnline(m,x[7],"flushPlanLineCache();refreshPlan();")){v=true}}var F="";var d="";if(x[16]&&x[16]>100){d="+"+(x[16]-100)+"%"}if(site_lang=="de"){F+="<td onmousedown='return false;' onclick='planMarkLine("+l+");' class=rb><img id='selImg"+l+"' src='img/kreis"+(planLinesSelected[l]?"_sel":"")+".png' />"+(showNewCachings?(linesBuildsCounter[l]==null?linesBuildsCounter[l]=0:++linesBuildsCounter[l]):"")+"</td>"}else{F+="<td></td>"}var R=getSpielerSpeedPicNr(x[1],x[2],x[6])+"&nbsp;"+(x[6]==1.5?"1½":x[6])+d;F+="<td class='i ' "+(!(x[PD_FORTOOLUSERID]>0)&&x[1]!=null?" style='background:#FBB;' onmouseover='missingToolUserIDTip();' ":"")+">"+getDorfBut(x[1],x[2],x[0],0)+"</td><td><img src='img/pfeil_lang_14.png' /></td><td class='i rb'>"+getDorfBut(x[3],x[4],x[0],1)+"</td><td class='i rb' align=center><div class='clickable'><div id='tp"+x[0]+"'></div><div onclick='openTypPopup("+l+");' style='color:"+types[x[5]][1]+"'>"+types[x[5]][0]+"</div></div></td><td class='i rb'><input style='"+(v?"color:green":"color:red")+"' class='i z' onfocus='closePopups();' onchange='changeStartTime("+x[0]+", this.value)' value='"+getZeit(x[7])+"' /></td><td class='i rb'><input id='idestT"+l+"' class='i z' onfocus='closePopups();' onchange='changeDestTime("+x[0]+", this.value)' value='"+getZeit(x[8])+"' /></td><td class=' rb' align=right>"+getTimeString(Math.round(b))+"</td><td class='i rb' align=center><div class='clickable' style='width:60px;'><div onclick='openSpeedPopup("+l+");'>"+R+"</div></div></td><td class='i rb' align=center><input class='i iw' onfocus='closePopups();' onchange='changeWellen("+x[0]+", this.value)' value='"+x[9]+"' /></td><td class=' rb' align=center><img class='goldbut' onclick='delRow("+l+");' src='img/close.png' height=14 /></td><td class=rb><img class='goldbut' onclick='copyRow("+l+");' src='img/copy.png' height=14 /></td><td class=i align=center><input class='i c' onfocus='closePopups();' onchange='changeComment("+x[0]+", this.value)' value=\""+x[13].replace(new RegExp('["]',"g"),"''")+'" /></td>';line_cache[l]=F}B.push("<tr class="+D+">"+line_cache[l]+"</tr>")}P++}}var h=P;if(h<=planPagerPage[G]*planPagerPageSize&&planPagerPage[G]>0){var w=0;h--;var J=h%(planPagerPageSize);w=(h-J)/planPagerPageSize;planPagerPage[G]=planPagerPage[G]==w||w<0?0:w;refreshPlan();return}if(r==0){B.push("<tr class=i2><td style='padding:15px;font-weight:bold;' align=center colspan=20>"+L.noentries+"</td></tr>")}else{if(h==0){B.push("<tr class=i2><td style='padding:15px;font-weight:bold;' align=center colspan=20>"+L.noentries+"</td></tr>")}}var T="";var a="";if(r>10){var N=0;var c="";for(var S=0;S<h;S+=planPagerPageSize){if(planPagerPage[G]==N){c=c+" <strong>["+(N+1)+"]</strong>"}else{c=c+" <a onclick='planSetPagerPage("+G+","+N+");'>["+(N+1)+"]</a>"}N++}var E=[];if(planPagerPage[G]>0){E[0]="<a onclick='planSetPagerPage("+G+","+(planPagerPage[G]-1)+");'>&lt;&lt; "+L.plantab_pager_prev+"</a> "}else{E[0]="<font color=gray>&lt;&lt; "+L.plantab_pager_prev+"</font> "}if(planPagerPage[G]<N-1){E[1]="<a onclick='planSetPagerPage("+G+","+(planPagerPage[G]+1)+");'>"+L.plantab_pager_next+" &gt;&gt;</a> "}else{E[1]="<font color=gray>"+L.plantab_pager_next+" &gt;&gt;</font> "}c=E[0]+" &nbsp; "+c+" &nbsp; "+E[1];var y="<select onchange='planSetPagerPageSize("+G+",this.value);' style='border:1px outset gray;padding:0;background:#DDD;'><option "+(planPagerPageSize==10?"selected":"")+">10</option><option "+(planPagerPageSize==20?"selected":"")+">20</option><option "+(planPagerPageSize==50?"selected":"")+">50</option><option "+(planPagerPageSize==10000?"selected":"")+" value='10000'>"+L.plantab_all+"</option></select>";T="<tr><td colspan=20 style='line-height:18px;background:#ddd;white-space:normal; border-top:1px dotted black;border-bottom:1px dotted black;padding:3px;padding-left:8px;'><div style='float:right;' class='gray'>"+L.plantab_entrys+": "+r+" ("+L.plantab_entrysAfterFilter+": "+h+")</div>"+L.plantab_entrysPerPage+": "+y+" &nbsp;|&nbsp; "+L.plantab_pages+": "+c+"</td></tr>";var u="";u+="<select onchange='planSetPagerFilterSpieler("+G+",this.value);' style='border:1px outset gray;padding:0;background:#DDD;'><option value=''>"+L.plantab_all+"</option>";for(var S=0;S<g.length;S++){u+="<option "+(planPagerFilterSpieler[G]!=""&&planPagerFilterSpieler[G]==g[S]?"selected":"")+">"+g[S]+"</option>"}u+="</select>";var Q="";Q+="<select onchange='planSetPagerFilterZielSpieler("+G+",this.value);' style='border:1px outset gray;padding:0;background:#DDD;'><option value=''>"+L.plantab_all+"</option>";for(var S=0;S<U.length;S++){Q+="<option "+(planPagerFilterZielSpieler[G]!=""&&planPagerFilterZielSpieler[G]==U[S]?"selected":"")+">"+U[S]+"</option>"}Q+="</select>";var C="";C+="<select onchange='planSetPagerFilterTyp("+G+",this.value);' style='border:1px outset gray;padding:0;background:#DDD;'><option value='-1'>"+L.plantab_all+"</option>";for(var S=0;S<types_index.length;S++){C+="<option value='"+types_index[S]+"' "+(planPagerFilterTyp[G]==types_index[S]?"selected":"")+">"+types[types_index[S]][0]+"</option>"}C+="</select>";var o="";if(planPagerFilterTyp[G]!=-1||planPagerFilterSpieler[G]!=""||planPagerFilterZielSpieler[G]!=""){o="&nbsp; &nbsp; &nbsp; &nbsp; <font color='red'><strong>"+L.plantab_filterActiveNotice+"</strong></font>"}a="<tr><td colspan=20 style='border-top:1px dotted black;background:#CCC;padding:3px;padding-left:8px;'>"+L.plantab_filterung+": "+L.plantab_start+": "+u+" &nbsp;|&nbsp; "+L.plantab_target+": "+Q+" &nbsp;|&nbsp; "+L.plantab_filterTyp+": "+C+" "+o+"</td></tr>"}B=A+a+T+O+B.join("")+T+"</table>";q.innerHTML=B;editorReady()}var editorReadyTimeout=0;var editorReadyScriptRunned=false;function editorReady(){if(editorReadyScriptRunned){return true}clearTimeout(editorReadyTimeout);editorReadyTimeout=setTimeout("editorReadyValidated();",50)}function editorReadyValidated(){editorReadyScriptRunned=true;try{if(typeof onEditorReadyScript!="undefined"){onEditorReadyScript()}}catch(a){alert("Error in Startup-Scripting. ")}}function planSetPagerFilterZielSpieler(b,a){planPagerFilterZielSpieler[b]=a;refreshPlan()}function planSetPagerFilterSpieler(b,a){planPagerFilterSpieler[b]=a;refreshPlan()}function planSetPagerFilterTyp(b,a){planPagerFilterTyp[b]=parseInt(a);refreshPlan()}function planSetPagerPageSize(a,b){planPagerPageSize=parseInt(b);refreshPlan()}function planSetPagerPage(a,b){planPagerPage[a]=b;refreshPlan()}function alertTimeParsingFailed(){var a=(L.date_format+"").replace("d","DD").replace("m","MM").replace("y","YY");if(site_lang=="de"){alert("Zeit konnte nicht erkannt werden!\n\nBenötigtes Format: "+a+" hh:mm:ss\n\nDD: Tag\nMM: Monat\nYY: Jahr\nhh: Stunden\nmm: Minuten\nss: Sekunden\n")}else{alert("Failed to parse time/date!\n\nDate/time format: "+a+" hh:mm:ss\n\nDD: Day\nMM: Month\nYY: Year\nhh: Hours\nmm: Minutes\nss: Seconds\n")}}var planLinesSelected=[];var lastMarkedLineId=null;var markedOptionsDiv=null;var planLinesSelectedMustRecountedFlag=false;var zeitMoveD=0;var zeitMoveH=0;var zeitMoveM=0;var zeitMoveS=0;var markedOptionsIsSmall=true;function delRow(c,d){Wizard.abort();var a=getLineByLineId(c);if(getPDataLineId(c)==pdata_temp){for(var b=0;b<pdata_temp.length;b++){if(pdata_temp[b]==a){pdata_temp.splice(b,1)}}}else{a[14]=1}setModified(c);if(planLinesSelected[c]===true){planLinesSelected[c]=false}if(d!==true){refreshPlan()}}function gl_delAllRows(c){if(!confirm(L.loeschen_confirm)){return}for(var b=0;b<pdata.length;b++){var a=pdata[b];a[14]=1}setModified(c);refreshPlan()}function Copyright(){return"byTheGetter"}function changeComment(c,b){var a=getLineByLineId(c);a[12]="-1";a[13]=b;setModified(c);refreshPlan()}var new_line_negative_id=-1;var ablageVisibility=false;function setAblageVisibility(a){if(ablageVisibility==a){return}ablageVisibility=a;dge("ablage_div").style.display=a?"block":"none"}function gl_insertAblage(){insertAblage()}function insertAblage(){var c=true;for(var b=0;b<pdata_temp.length;b++){for(var a=0;a<4;a++){if(pdata_temp[b][a]==null){c=false}}}if(!c){return alert("Es befinden sich noch unvollständige Einträge in der Ablage.\n\nZum Einfügen müssen die Einträge vollständig sein. ")}pdata=pdata.concat(pdata_temp);pdata_temp=[];setAblageVisibility(false);setModified();refreshPlan()}function copyRow(f,g){var c=getLineByLineId(f);var b=new_line_negative_id;new_line_negative_id--;var a=[];for(var d=0;d<c.length;d++){a[d]=c[d]}a[0]=b;pdata_temp.push(a);if(g!==true){refreshPlan()}return b}function gl_addPlanLine(){addPlanLine()}function gl_wiederherstellen(a){if(isModified){if(site_lang=="de"){if(!confirm("Warnung! \n\nBeim Fortfahren werden sämtliche Veränderungen\nseit der letzten Speicherung gelöscht!\n\nFortfahren?")){return}}}else{if(pdata_temp.length>0){if(site_lang=="de"){if(!confirm("Warnung! \n\nEs befinden sich noch Einträge in der Ablage,\ndiese werden beim Fortfahren gelöscht.\n\nFortfahren?")){return}}}}isModified=false;location.href=a}function getArrJSON(c){var b=[];for(var a=0;a<c.length;a++){var d=c[a];if(typeof d=="object"){d=getArrJSON(d)}else{if(typeof d=="string"){d='"'+d.replace("\n","\\n").replace('"',"").replace("'","")+'"'}else{if(typeof d=="number"){}else{return alert("Unknown type: "+typeof d)}}}b.push(d)}return"["+b.join(",")+"]"}function getPDataJSON(){return getArrJSON(getPData())}function getSaveData(){return encodePost(getPDataJSON())}var savedata=null;var saveCryptedData="";var savedData="";var savingInProgress=false;var SpeicherDivWidth=160;function delayedSavingWithAnzeige(f){if(f==null){savedata=getPDataJSON();f=-1;saveCryptedData=""}var b=100;var d=b*(f+1)-1;var c=Math.ceil(savedata.length/b);if(f>0){saveCryptedData+=","}if(f>=0){saveCryptedData+=encodePost(savedata.substr(b*f,b))}if(f>=0){savedData+=savedata.substr(b*f,b)}var a;if(f>0){a=Math.round(f/c*SpeicherDivWidth)}else{a=0}dge("saveFortschrittDiv").innerHTML="<div style='border:1px gray dotted;padding:1px;'><div style='width:"+a+"px;height:12px;background:green;border:1px outset green;'></div>";if(b*(f+1)>=savedata.length){saveFormDataInput.value=saveCryptedData;saveFormForm.submit();setTimeout("delayedSavingWithAnzeigeBlink(0);",10)}else{setTimeout("delayedSavingWithAnzeige("+(f+1)+");",0)}}function delayedSavingWithAnzeigeBlink(a){if(a==0){dge("saveFortschrittDiv").innerHTML="<div style='border:1px gray dotted;padding:1px;'><div style='width:"+SpeicherDivWidth+"px;height:12px;background:green;border:1px outset green;'></div>"}if(a==1){dge("saveFortschrittDiv").innerHTML="<div style='border:1px gray dotted;padding:1px;'><div style='width:"+SpeicherDivWidth+"px;height:12px;background:darkgreen;border:1px inset darkgreen;'></div>"}setTimeout("delayedSavingWithAnzeigeBlink("+((a*1+1)%2)+");",150)}var saveFormDataInput=null;var saveFormForm=null;var CRYPT_SAVEPLANCMD="gl_SP();";function gl_SP(){if(pdata_temp.length>0){if(site_lang=="de"){if(confirm("! Warnung !\n\nIn der Ablage befinden sich noch Einträge.\n\nDiese jetzt in den Einsatzplan übernehmen?\n (Werden sonst unwiederruflich gelöscht)")){insertAblage()}}}if(pdata_temp.length>0){if(site_lang=="de"){if(!confirm("Warnung! \n\nEs befinden sich noch Einträge in der Ablage,\ndiese werden beim Fortfahren gelöscht.\n\nFortfahren?")){return}}}var a=document.createElement("div");a.innerHTML="<div style='position:fixed;left:50%;top:50%;border:2px outset #EEE;background:#EEE;'><div style='padding:2px 10px;background:blue;color:white;font-size:16px;font-weight:bold;'>"+L.save_title+"</div><div style='padding:20px;text-align:center;'><br />"+L.save_text+"<br /><br /><div id='saveFortschrittDiv'></div><br><br></div></div>";document.body.appendChild(a);setTimeout("savePlan();")}function gl_savePlan(){eval(CRYPT_SAVEPLANCMD)}function savePlan(){if(savingInProgress){return alert("Es wird schon gespeichert!")}savingInProgress=true;delayedSavingWithAnzeige()}function getRunTime(ev,times){var begTime=new Date().getTime();for(var i=0;i<times;i++){eval(ev)}var endTime=new Date().getTime();var diffTime=endTime-begTime;return diffTime}function testTime(){var b=0;var c=getRunTime("refreshPlan();",10);b+=c;gl_showRapidMode();var a=getRunTime("rapidModeRefresh();",10);b+=a;alert("Zeit-Test: "+(b/1000)+" ms\n\n10 x PlanBuild: "+(c/1000)+" ms\n10 x RapidMode: "+(a/1000)+" ms\n")}if(TESTTIME){setTimeout("testTime();",1500)}if(DEBUG_MODE){if(TEST_RAPID_MODE){rapidModeFeindListe=["ego","maverick","look now","der freak"];setTimeout("gl_toogleRapidMode();",500)}}function onclosehandler(){if((location.href+"").indexOf("127.0.0.1")>-1){return}if(site_lang=="de"){if(isModified&&!savingInProgress){alert("Hinweis: Beim Verlassen dieser (Editor-) Seite werden alle nicht gespeicherten Veränderungen unwiederruflich gelöscht! ");return false}}}}catch(e){alert("Error 33.0")};