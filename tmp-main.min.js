/**
*  Skript Main
*
*  Copyright (c) TheGetter 2018
*  Alle Rechte vorbehalten.
*
*  Dieses Skript ist urheberrechtlich geschützt.
*  Die Nutzung ist auf dem Server des Copyright-Inhabers, und nur dort gestattet.
*  Kopieren, Veränderungen, Verwendung auf anderen Seiten, Reengineering von
*  Teilen oder dem gesamten Skript ohne Einverständnis des Copyright-Inhabers
*  sind ausdrücklich nicht erwünscht.
*  Zuwiderhandlung gegen die Nutzungsbedingungen können rechtliche Konsequenzen haben.
*
*  Ressource: GT2/ressource/script/main
*  Modified:  2018-05-25 03:16:30
*  Checksum:  6305fabf6602e3a119ac3e6cbd20dd3b
*/
function dge(a){return document.getElementById(a)}function openWiki(a,c,d){if(c!=null){c=c.replace(/ /g,"_")}var b="71-Wiki?goto="+a+(c!=null?"_XXX_"+c:"");if(d){window.open(b,"_blank")}else{openURLInOverLayFrame(b,"Getter Tools 2.0 - Online-Hilfe","wiki")}}function oif(b,c,a){if(a==null){a=c.replace(/[^a-zA-Z0-9_]/g,"")}openURLInOverLayFrame(b,c,a)}function openURLInOverLayFrame(b,e,a){if($("body").is(".contentOnly")||isMsie()){window.open(b,a);return}var c={width:"100%",height:"90%","box-sizing":"border-box"};var d=$("<iframe />").prop("src",b).css(c).addClass("absatzBack");$div=$("<div class='absatzNoWidth' />").css(c).append($("<h2 />").html(e).append("<img alt='' style='position:absolute;right:10px;top:50%;margin-top:-16px;cursor:pointer;'src='"+BASE_DIR+"img/cow/cross.png' class='close' />")).append(d);$div.popup().open();return}$(function(){function b(f){var g=0;var e=[];for(var c=0;c<f.length;c++){var h=typeof f[c]=="number"?[1,f[c],]:f[c];e.push("<div class='gfx' style='height:"+h[0]+"px;top:"+h[1]+"px;left:"+g+"px;'></div>");g++}return e.join("")}function a(){var d=new Date().getTime();var c=10;$("div.ewgfx.todo").each(function(){var e=$(this).removeClass("todo");e.html(b($.parseJSON("["+e.data("ewsdata")+"]")));if(c--<0&&new Date().getTime()-d>100){setTimeout(a,50);return false}})}$("div.ewgfx").addClass("todo");setTimeout(a,1)});var tabData=[];function preserveTableSort(c){var f=dge(c);var b=f.childNodes[0];var o=b.childNodes[0];var l=b.childNodes[1];var n=[];if(l!=null){var k=l.childNodes.length;for(var g=0;g<k;g++){var m=l.childNodes[g];if(m!=null&&m.tagName!=null&&m.tagName.toLowerCase()=="td"){n[n.length]=m.innerHTML.replace(/<[^>]*>/g,"")}}}var k=o.childNodes.length;var a=0;for(var g=0;g<k;g++){var m=o.childNodes[g];if(m!=null&&m.tagName!=null&&m.tagName.toLowerCase()=="td"){var d=m.getAttribute("colspan");if(d==null||!isFinite(d)){d=1}var i=false;try{if(n[a]!=null&&isFinite(n[a])){i=true}}catch(h){}m.className+=" linkStyle";m.onclick=new Function('initTableSort("'+c+'",'+a+","+(!i)+");");if(d>1){a+=d-1}}a++}}function initTableSort(y,q,I){try{var c=dge(y);var s=c.getElementsByTagName("tbody")[0];var o=s.childNodes.length;var a=[];if(o==0){return}for(var E=0;E<o;E++){var k=s.getElementsByTagName("tr")[E];if(k!=null&&k.tagName!=null&&k.tagName.toLowerCase()=="tr"){var p=k.getElementsByTagName("td").length;var n=[];for(var D=0;D<p;D++){var b=k.getElementsByTagName("td")[D];var r=b.className;if(b!=null&&b.tagName!=null&&b.tagName.toLowerCase()=="td"){var h=b.innerHTML.replace(/<[^>]*>/g,"");var z=b.width;var C=b.align;var d=b.getAttribute("colspan");if(d==null||!isFinite(d)){d=1}var x=h;if(b.className.indexOf("sort")>=0){var f=new RegExp("sort([0-9-]+)");var l=f.exec(b.className);if(l!=null){x=l[1]}}if(isFinite(x.replace(/[.,%\(\)+]/g,""))&&x!=""){x=x.replace(/[.,%\(\)+%]/g,"")*1}else{if(isFinite(x)&&x!==""&&x!==null){x=x*1}else{if(x=="-"){x=0}else{x=x.toLowerCase()}}}if(E==0){x="HEAD"}eingetragenerColspan=d;for(var u=0;u<d;u++){n[n.length]=[b.innerHTML,x,r,z,C,eingetragenerColspan];eingetragenerColspan=0}}}var v=k.style;var g=k.className;var m=k.getAttribute("onmouseover");var A=k.getAttribute("onmouseout");a[a.length]=[n,g,v,m,A]}}var H=c.style.cssText;var B=c.className;var w=c.getAttribute("cellspacing");var G=c.getAttribute("cellpadding");tabData[y]=[a,B,H,w,G,null,null];drawTable(y);if(q!=null){sortTable(y,q,I)}}catch(F){scriptErrors[0]="Tabellenfunktionsfehler.Err.1. Die Sortierung ist dadurch nicht möglich.."}}var sortCol=0;var sortAsc=false;function sortTableComperator(d,c){if(d[0][sortCol][1]=="HEAD"){return -1}if(c[0][sortCol][1]=="HEAD"){return 1}if(d[0][sortCol][1]>c[0][sortCol][1]){return(sortAsc?1:-1)}if(d[0][sortCol][1]<c[0][sortCol][1]){return(sortAsc?-1:1)}return 0}function sortTable(g,c,d){var b=null;try{var a=tabData[g];b=a[0];sortCol=c;sortAsc=d;a[5]=sortCol;a[6]=sortAsc}catch(f){scriptErrors[0]="Tabellenfunktionsfehler.Err.2.0. Die Sortierung ist dadurch nicht möglich.."}try{b.sort(sortTableComperator)}catch(f){scriptErrors[0]="Tabellenfunktionsfehler.Err.2.1. Die Sortierung ist dadurch nicht möglich.."+f}try{drawTable(g)}catch(f){scriptErrors[0]="Tabellenfunktionsfehler.Err.2.2. Die Sortierung ist dadurch nicht möglich.."}}function drawTable(r){try{var d=tabData[r];var a=d[0];var p=a.length;var n="";for(var w=0;w<p;w++){var k=a[w][0];var h=k.length;var f=a[w][1];var l=a[w][3];var t=a[w][4];if(f=="it1"||f=="it2"){f=(w%2==0?"it2":"it1")}var c="";if(l!=null&&l!=""){c="onmouseover='"+l+"' onmouseout='"+t+"' "}n+="<tr class='"+f+"' "+c+">";for(var v=0;v<h;v++){var x=k[v][0];var q=k[v][2];var s=k[v][3];var u=k[v][4];var b=k[v][5];var A=x;if(w==0){var g=d[5]==v;var y=d[5]==v&&d[6]!=false;var o=false;if(d[0][1]!=null&&isFinite((d[0][1][0][v][1]+"").replace(/[.,%\(\)+]/g,""))&&d[0][1][0][v][1]!==""&&d[0][1][0][v][1]!==null){o=true}if(o&&d[5]!=v){y=true}A="<a onclick='sortTable(\""+r+'",'+v+","+(y?"false":"true")+");'>"+A+""+(g?(y?"&darr;":"&uarr;"):"&nbsp;&nbsp;")+"</a>"}n+="<td class='"+q+"' "+(s!=""?"width='"+s+"'":"")+" "+(u!=""?"align='"+u+"'":"")+" "+(b>1?"colspan='"+b+"'":"")+">"+A+"</td>";if(b>1){v+=b-1}}n+="</tr>"}var m=$("#"+r);m.prop("class",d[1]).prop("style",d[2]).prop("cellspacing",d[3]).prop("cellpadding",d[4]).html(n)}catch(z){scriptErrors[0]="Tabellenfunktionsfehler.Err.3. Die Sortierung ist dadurch nicht möglich.."}}(function(){var g=new Array();var d=5;var a=1.2;var f=200;var h="#00AA55";var e=9;var b="logo";function c(l){for(var k=0;k<g.length;k++){var m=d-Math.abs((l-k*d))/a;if(m<0){m=0}else{m=m*(100/d)/100}m=Math.min(1,m);if(!isMsie()){g[k].style.opacity=m}else{g[k].style.filter="Alpha(opacity="+(m*100)+")"}g[k].style.display=isMsie()&&m==0?"none":"block"}if(l>=(e+1)*d){l=Math.round(-d*a)}var j=f;if(isMobile()){j=10000}setTimeout(function(){c((l+1))},j)}function i(j){if(j==null){setTimeout(function(){i(true)},500);return}if(!dge(b)){return}var l="";for(var k=0;k<e;k++){l+="<div id='fade"+k+"'></div>"}dge(b).innerHTML+=l;for(var k=0;dge("fade"+k)!=null;k++){g[k]=dge("fade"+k)}for(var k=0;k<g.length;k++){g[k].style.cssText="border:1px outset "+h+";background:"+h+";position:absolute;top:45px;left:"+(k*20)+"px;width:10px;height:10px;"}c(0)}$(i)})();var wiki_helps=[];wiki_helps.start="Getter Tools 2.0";wiki_helps.travianmap="T-Map 2.0";wiki_helps.mysite="Meine Tools";wiki_helps.myprofile="Meine Tools";wiki_helps.troops="Truppentool - Meine Truppen";wiki_helps.profile="Truppentool - Mein Profil";wiki_helps.oz="Truppentool - Onlinezeit und Kulturpunkte";wiki_helps.groups="Truppentool";wiki_helps.getreide="Getreide-Tool";wiki_helps.kbs="Kampfberichte-Archiv";wiki_helps.defftabs="Deff-Tabellen";wiki_helps.embeddedMap="GetterMap";wiki_helps.editor="Einsatzplan-Editor";wiki_helps.tools="Rechner/Tools";wiki_helps["abfang-rechner"]="Abfangrechner";wiki_helps.kultur="Kulturpunkte-Rechner";wiki_helps.wege="Wegerechner";wiki_helps["weg-zeit"]="Wege-Zeit-Speed-TP-Rechner";wiki_helps.techcalc="Forschungs-Rechner";wiki_helps["truppen-saven"]="Truppen-saven-Rechner";wiki_helps.npc="NPC-Rechner";function isMsie(){return(document.all?true:false)}function setQuickSpeed(a,b){dge(a).value=b=="-1"?"":b}function count(b){if($.isArray(b)){return b.length}else{var a=0;$.each(b,function(){a++});return a}}function setQuickDorf(b,c,f){var e=0,a=0,g=0;if(f!="-1"){var d=f.split("|");a=d[0];g=d[1];if(d[2]!=null){e=d[2]}}if(dge(b)){dge(b).value=a+"|"+g}if(dge(b+"X")){dge(b+"X").value=a}if(dge(b+"Y")){dge(b+"Y").value=g}if(c!=""){dge(c).value=e}}function getTravKoordsXY(c){var b=Math.round((travMapSize-1)/2);var a=intval(c%travMapSize);return[a-b-1,b-((c-a)/travMapSize)]}function getTravKoords(a,c){var b=Math.round((travMapSize-1)/2);return(intval(a)+b+1)+(b-intval(c))*travMapSize}function getImgCfg(){var a={base:BASE_DIR+"img/trav/3/u/",unitImgExt:"gif",travIcon:BASE_DIR+"img/trav/3/u/9.gif"};if(tversion>=3.5){a.base=BASE_DIR+"img/trav/3.5/u/";a.unitImgExt="gif"}if(tversion>=4){a.base=BASE_DIR+"img/trav/4/u/";a.unitImgExt="gif";a.travIcon=BASE_DIR+"img/favicon-t4.ico"}if(tversion>=5){a.base=BASE_DIR+"img/trav/kd/u/";a.unitImgExt="png";a.travIcon=BASE_DIR+"img/kd/favicon-16.png"}return a}function getTUImgFile(b,a){return getImgCfg().base+(b*10-10+1+a)+"."+getImgCfg().unitImgExt}function myOpenTip(b,a){Tip(b,STICKY,true,DELAY,500,BGCOLOR,"#DDD",BORDERCOLOR,"#AAA",BORDERSTYLE,"outset",BORDERWIDTH,2,DURATION,10000,OFFSETY,-25,OFFSETX,35,PADDING,0,CLICKCLOSE,true,FADEIN,250,TITLE,a,TITLEBGCOLOR,"blue")}function openTTMemberProfile(a){window.open("?mProfile="+a,"_blank","width=900,height=700,location=no,scrollbars=yes")}function scaleMe(a,g,e){dim=new Image();dim.src=a.src;var d=dim.width;var c=dim.height;var b=g/e;var h=0;var f=0;if(d>g||c>e){if(d/c>b){h=g;f=c*(g/d)}else{f=e;h=d*(e/c)}}else{h=d;f=c}a.height=f;a.width=h}function setAttOkX(d,b){var a="TravianTools2.php?m=groups&gid="+GID;var c="action="+b+"&id="+d+"&"+sectok;$.post(a,c)}(function(){var a=[];window.ldTbl=function(e,d,b){if(d<0){return}if(a[e+"_"+d]!=null){return dge(e).innerHTML=a[e+"_"+d]}a[e+"_"+d]="";url=location.href;var c="loadSpielerData=1&id="+e+"&pos="+d+"&"+sectok;if(b!=null){c+="&howMany="+b}$.post(url,c,function(f){a[e+"_"+d]=f;dge(e).innerHTML=f})}})();function startMapA(b,a){dge(a).innerHTML="<iframe src='"+BASE_DIR+"TravianTools2.php?m=embeddedMap&semb&said="+b+"' width=470 height=359></iframe>"}function startMapS(a,b){dge(b).innerHTML="<iframe src='"+BASE_DIR+"TravianTools2.php?m=embeddedMap&semb&suid="+a+"' width=470 height=359></iframe>"}function initMakeH2Helper(){try{var a=document.getElementsByTagName("h2");var c=true;if(site_lang=="de"){for(var b=0;b<a.length;b++){var k=a[b];var f=k.className;if(f!=null){if(f.toLowerCase().indexOf("nohelp")==-1){var g=k.id;if(c&&(g==null||g=="")){g=wikithema}c=false;if(wiki_helps[g]!=null){k.style.position="relative";var i=document.createElement("div");i.style.cssText="position:absolute; right:"+(isMsie()?18:1)+"px; top:"+(isMsie()?2:1)+"px; height:26px; width: 26px;";i.className="goldbut";var h=wiki_helps[g];i.onmouseover=new Function("Tip('Hilfe zum Thema: \""+h+"\"aufrufen.');");i.onclick=new Function("openWiki('"+h+"','"+k.innerHTML.replace(/<[^>]*>/g,"").replace(/'/g,"")+"');");i.innerHTML="<img style='position:absolute;left:0;top:0;margin:2px 0 0 2px;' src='"+BASE_DIR+"img/help_24."+(isMsie()?"gif":"png")+"' height='24' />";k.appendChild(i)}}}}}}catch(d){}}function writeZitat(){var b=["GT2 - Dann klappts auch mit dem Nachbarn!","Zwei Dinge sind unendlich, das Universum und die menschliche Dummheit, aber bei dem Universum bin ich mir noch nicht ganz sicher.","Phantasie ist wichtiger als Wissen, denn Wissen ist begrenzt.","Probleme kann man niemals mit derselben Denkweise lösen, durch die sie entstanden sind.","Das, wobei unsere Berechnungen versagen, nennen wir Zufall.","Ich denke niemals an die Zukunft. Sie kommt früh genug.","Zeit ist das, was man an der Uhr abliest.","Gott würfelt nicht.","Wenn 50 Millionen Menschen etwas Dummes sagen, bleibt es trotzdem eine Dummheit.","Die Freiheit ist ein Luxus, den sich nicht jedermann gestatten kann.","Was man mit Gewalt gewinnt, kann man nur mit Gewalt behalten.","Der Klügere gibt nach! Eine traurige Wahrheit, sie begründet die Weltherrschaft der Dummheit.","Nichtstun macht nur dann Spaß, wenn man eigentlich viel zu tun hätte.","Vegetarier: Essen meinem Essen das Essen weg!","Ihr aber seht und sagt: Warum? Aber ich träume und sage: Warum nicht?","Dummheit ist auch eine natürliche Begabung.","Die beste und sicherste Tarnung ist immer noch die blanke und nackte Wahrheit. Die glaubt niemand!","Wer die Freiheit aufgibt, um Sicherheit zu gewinnen, wird am Ende beides verlieren.","Um sicher Recht zu tun, braucht man sehr wenig vom Recht zu wissen. Allein um sicher Unrecht zu tun, muß man die Rechte studiert haben.","Die meisten Menschen sind so glücklich, wie sie es sich selbst vorgenommen haben.","Das Ganze ist mehr als die Summe seiner Teile.",""];var a=Math.round(Math.random()*((b.length)-1));$("#spruchDiv").html("<div style='position:relative;top:0px;left:0px;width:100%;text-shadow:1px 1px 1px black;'>"+b[a]+"</div>")}function showTipSpan(b,c){c=c||300;if(typeof ToolTip!="undefined"){ToolTip.show(b,"",$(b).find(".htip").html(),{width:c,delay:100})}else{var d="";for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a].className=="htip"){d=b.childNodes[a].innerHTML}}Tip(d,WIDTH,c)}}function zdInsert(f,c,b,a,g,e){var d="izd=1&fx="+f+"&fy="+c+"&tx="+b+"&ty="+a+"&sp="+g+"&dt="+e+"&"+sectok;$.post(zdurl,d)}(function(){var b=0;var a=1000*(60*60*4+b);function c(){var e=$("<div class='absatzNoWidth' />").prop("id","sessionTimeoutID").css("width","300px");var h="Sicherheitshinweis";var g="Die Gültigkeit der aktuellen Seite läuft in wenigen Minuten ab. <br />Aus Sicherheitsgründen sind geschützte Seiten und Formulare nur eine begrenzte Zeit lang gültig.<br /><br />Zum Erneuern der Session einfach Seite neuladen.";var f="Ok - Neuladen";var d="Ignorieren";if(site_lang!="de"){h="Security notice";g="Page session expires in a few minutes.<br />For security all forms and sites expires after a few hours.<br /><br />To renew your session just reload.";f="OK - reload";d="Ignore"}e.html("<h2>"+h+"</h2><div class='absatzBack'>"+g+"<br /><button class='stylebutton' style='float:right;' type='button' onclick='location.href=location.href.split(\"#\")[0]+\"\"'>"+f+"</button><button class='stylebutton close' type='button' >"+d+"</button></div>");e.popup({}).open()}if(typeof sessionTimeoutable!="undefined"&&sessionTimeoutable){setTimeout(c,a)}})();function secViolation(){var a="";if(site_lang=="de"){a="Sicherheitsprotokoll\n\nDie Gültigkeit der aktuellen Seite ist abgelaufen. Die letzte Aktion wurde daher nicht ausgeführt. Lade die Seite neu und versuche es nocheinmal.\n\nDrücke OK um die Seite neuzuladen"}else{a="Security protocol\n\nYour Page-Session has expired. Your last action was dropped. Please reload the page and try again. \n\nPress OK to reload the Page"}if(confirm(a)){location.href=location.href+""}}var TimeZoneDetector=(function(){function b(g,e){var f=new Date();f.setDate(g);f.setMonth(e);f.setFullYear(2009);f.setHours(12);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);return f.getTimezoneOffset()}function a(d,e){if(d!=b(1,0)||e!=b(1,5)){c()}}function c(){var f={action:"findMyTimezone",mons:[]};for(var e=0;e<12;e++){f.mons[e]={};for(var g=1;g<=28;g+=7){f.mons[e][g]=b(g,e)}}Ajax.postGlobal(f)}return{checkZone:a,detect:c}})();function submitPost(e,b){if(!b){b=""}function d(){var i=null;$.each(sectok.split("&"),function(j,k){var l=k.split("=");if(l[0]!=="ajax"){i=l}});return i}var g=null;if(dge("genform")){g=dge("genform")}else{g=document.createElement("form");g.method="post"}g.action=b;if(!$.isArray(e)){var h=e;e=[];$.each(h,function(i,j){e.push([i,j])})}var a=d();if(a){e.push(a)}for(var c=0;c<e.length;c++){var f=document.createElement("input");f.type="hidden";f.name=e[c][0];f.value=e[c][1];g.appendChild(f)}document.body.appendChild(g);g.submit()}function getArrJSON(c){var b=[];for(var a=0;a<c.length;a++){var d=c[a];if(typeof d=="object"){d=getArrJSON(d)}else{if(typeof d=="string"){d='"'+d.replace("\n","\\n").replace('"',"").replace("'","")+'"'}else{if(typeof d=="number"){}else{if(typeof d=="boolean"){d=d?"true":"false"}else{return alert("Unknown type: "+typeof d)}}}}b.push(d)}return"["+b.join(",")+"]"}function goLang(a){submitPost({action:"lang",lang:a},location.href.replace(/#.*$/,""))}function showMobLogin(){m_closeMenu();var a=$("#login form.loginForm").clone().popup()}(function(){var c=null;function d(){if(c!=null){b()}clearTimeout(c);$(this).addClass("el_hover");$(this).parents("li").addClass("el_hover")}function a(){clearTimeout(c);c=setTimeout(b,500)}function b(){clearTimeout(c);c=null;$(".menu-desktop li").removeClass("el_hover")}$(document).ready(function(){$(".menu-desktop li.hasSubMenu").hover(d,a)})})();function intval(b){try{val=parseInt(b);if(!isNaN(val)){return val}}catch(a){}return 0}(function(){var a=null;function b(){var c=$(this);if(!a){$().popup().showLoading();var d="mode="+wwmode+"&languagePopup=1&"+sectok;$.post(wwurl,d,function(e){a=$(e).popup({scrollableContent:".absatzBack"})});return}else{a.open()}}$(function(){$("#openLanguagePopup").click(b);$("#m_openLanguagePopup").click(b)})})();function unhtml(a){$.each({"&amp;":"&","&quot;":'"',"&#039;":"'","&lt;":"<","&gt;":">"},function(b,c){a=a.replace(new RegExp(b,"g"),c)});return a}function Lg(c,b){var a=L[c]||"";$.each(b,function(d,e){a=a.replace(new RegExp("{"+d+"}","g"),e)});return a}jQuery.getScriptCached=function(b,a){a=$.extend(a||{},{dataType:"script",cache:true,url:b});return jQuery.ajax(a)};function loadJQueryUI(b){if(typeof jQuery.fn.autocomplete==="function"){b()}else{function a(c){var d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=c;document.getElementsByTagName("head")[0].appendChild(d)}a(loadJQueryUiOnDemand[1]);jQuery.getScriptCached(loadJQueryUiOnDemand[0]).done(b)}}function isMobile(){return $(window).width()<=800}function messung(a){var b=new Date().getTime();a();alert(new Date().getTime()-b)}function makeFormDisabled(b){b.css("position","relative").find("input,select,button[type=submit]").prop("disabled",true);var c=b.find("table:first>tbody>tr").not("tr:first").css("opacity",0.5).position();var a=$("<div />").hide().css("position","absolute").offset(c).width(b.width()).height(b.height()-c.top).click(function(){$.each({"1":"#eaa","100":"","300":"#eaa","400":""},function(e,d){setTimeout(function(){b.find("button.button-openWorldChooser").css("background",d)},e)})}).hide();b.append(a);setTimeout(function(){a.show()},1)}$(function(){var a=false;for(var b=2;b<trapped.length;b++){if(trapped[b]){a=true}}if(svdAdbl!=-1){if(svdAdbl==0||(svdAdbl==1&&!a)||(svdAdbl==2&&a)){adblNewVal=(a?1:2);Ajax.postLocal({adblNewVal:adblNewVal})}}var d=0;var c=theme!="schlicht";try{if(theme!="schlicht"){$(initMakeH2Helper)}}catch(f){}if(lang==="de"){writeZitat()}$("form.makeFormDisabled").each(function(){makeFormDisabled($(this))})});var Ajax=(function(){function b(c,d,e){sendAjaxCall(c,d,e,{url:ajaxUrl})}function a(c,d,e){sendAjaxCall(c,d,e)}return{postGlobal:b,postLocal:a}})();function sendAjaxCall(a,e,c,d){function b(h,i,g){if(h.transmitted){if(e){e.call(this,h.payload)}}else{if(c){c.call(this,g)}}}function f(){var g={};$.each(sectok.split("&"),function(h,i){var j=i.split("=");g[j[0]]=j[1]});return g}$.ajax($.extend({},{type:"POST",url:location.href,data:$.extend(a,f()),success:b,error:c,dataType:"json"},d))}var MobileMenu=(function(){var g;var f=null;var e=null;var c={};function b(){function o(t,u){var s=this;this.level=u;this.$a=t.find(">a");c[this.$a.prop("href")]=this;if(this.$a.prop("href")==location.href){f=this}this.parent=null;var p=null;this.add=function(v){p.push(v);v.parent=s};this.$nachgeladeneNavi=null;this.getNodes=function(){if(p===null){var v=t.find(">ul>li");if(this.$a.data("linkgid")){$test=$("li.js-ttnavi-gid-"+this.$a.data("linkgid"));if(this.$nachgeladeneNavi){$test=this.$nachgeladeneNavi.find("li.js-ttnavi-gid-"+this.$a.data("linkgid"))}if($test.find(">ul>li").length>0){v=$test.find(">ul>li");this.$a=$test.find(">a").clone().addClass("nodeLink notsel load-feedback")}else{this.fakeSubMenu=this.$a.data("linkgid");return[]}}p=[];v.each(function(){var w=l($(this),u+1);s.add(w)})}return p};this.hasSubmenu=function(){return this.getNodes().length>0};var q=-1;function r(v){v=v.clone();if(v.data("bigicon")){v.find(">img").replaceWith("<img class='cow' alt='' src='"+v.data("bigicon")+"' >")}return v.addClass("load-feedback")}this.get$ul=function(){if(q===-1){q=$();if(this.hasSubmenu()){q=$("<ul />").data("node",this);$.each(this.getNodes(),function(w,v){var x=r(v.$a).addClass("nodeLink notsel");var y=$("<li>").html(x);if(v.hasSubmenu()||v.fakeSubMenu){y.append($("<a class='m_goNode notsel'><span class='m_pfeilRechts'></span></a>").click(function(){var z=$(this);if(v.fakeSubMenu){sendAjaxCall({getTTNavigation:1},function(B){var A=$(B.navigation);v.$nachgeladeneNavi=A;i(v);z.removeClass("bg-ajax-loading")},function(){},{url:v.$a.prop("href")});z.addClass("bg-ajax-loading")}else{i(v)}}));y.addClass("m_hasSubMenu")}q.append(y)});if(this.level>0){q.append($("<li class='m_menuBack'><a class='notsel'><span class='m_pfeilLinks'></a></li>").click(function(){i(s.parent)}));q.prepend($("<li class='m_menuSelf'></li>").append(r(this.$a)));q.addClass("m_hasMenuBack")}g.append(q)}}return q};this.getNodes()}var k=[];var h=l($(".menu-desktop"),0);function l(q,r){var p=new o(q,r);k.push(p);return p}var m=$();$.each(k,function(p,q){});function i(u,q){u=u||h;var p=g.find(">ul:visible").not(u.get$ul());var s=p.data("node");var t=u.get$ul();if(q){u.get$ul().show()}else{var r=!s||s.level<u.level;p.animate({left:r?"-100%":"100%"},function(){$(this).hide()});t.css("left",r?"100%":"-100%").show().animate({left:0});t.find(".m_menuBack a").css("lineHeight",t.height()+"px");$(".navigationOuter").animate({scrollTop:0})}g.animate({height:t.height()+(intval(g.css("border-top-width"))*2)+"px"})}function n(){if(e===null){g.before(e=$("<div class='mobLocation' />"))}var r=node;var p=[];do{var q=r.$a.text();if(q.length>20){q=q.substring(0,20)+"..."}q&&p.unshift(q)}while(r=r.parent);e.html(p.join(" &gt; "))}g.find(">ul").hide();$(".menu-desktop").addClass("notMobile");if(!f){var j=$(".tt_navi .rsel");f=j.length>0?c[j.prop("href")]:null}if(f){f=f.parent}i(f,1);$(".partNaviLinks #rightNavi").append($(".bottomLine a.imprint").clone());$(".partNaviLinks #rightNavi").append(" | ");$(".partNaviLinks #rightNavi").append($(".bottomLine a.privacy").clone());$(".partNaviLinks #rightNavi").append("<span class='mobilyOnly'> | <a onclick='submitPost({force_desktop:1});'>Desktop</a></span>");a=true}var a=false;function d(){g=$(".mobMenu").addClass("mobileOnly");$(".navigationOuter").addClass("hide");e=null;$(".mobileMenuButton").click(function(){if(!a){$(".navigationOuter").removeClass("hide");b()}if($(".mobileMenuButton").is(".open")){m_closeMenu();setTimeout(function(){$(".navigationOuter").addClass("hide")},300)}else{$(".navigationOuter").removeClass("hide");setTimeout(function(){$(".navigationOuter,.mobileMenuButton,body>header").addClass("open")},1);location.href="#mmenu"}});var h=false;window.setInterval(function(){if(!!$(window).scrollTop()!=h){h=!!$(window).scrollTop();$(".mobileMenuButton").toggleClass("mobileMenuButtonScrolled",h)}},100);window.m_closeMenu=function(){$(".navigationOuter,.mobileMenuButton,body>header").removeClass("open");location.href="#-"};var i=location.href;window.addEventListener("popstate",function(){var j=i;i=location.href;if(j.indexOf("#mmenu")>-1&&location.href.indexOf("#mmenu")==-1){m_closeMenu()}})}$(d);return{}})();(function(){var a=null;var b=null;function c(){m_closeMenu();var d=$(this);if(!a){a=$(b=$("form.globalsearch").clone().css("font-size","250%")).popup({top:20})}a.open();b.find("input").css({width:"100%"}).select().click()}$(function(){$("#m_openSearchBar").click(c)})})();var ScrollAreaHandler=(function(b){(function(e){e.fn.hasScrollBar=function(){return this.get(0).scrollWidth>(this.width()+intval(this.css("padding-left"))+intval(this.css("padding-right")))}})(jQuery);function d(g){var f=g[0].scrollLeft+5<=Math.floor(g.get(0).scrollWidth-g.width()-intval(g.css("padding-left"))-intval(g.css("padding-right")));var e=Math.round((g[0].scrollLeft+5)/Math.floor(g.get(0).scrollWidth-g.width()-intval(g.css("padding-left"))-intval(g.css("padding-right")))*100);g.data("scrollIndLeft").css("left",Math.round(-40*(100-e)/100)+"px").toggle(g[0].scrollLeft>0);g.data("scrollIndRight").css("right",Math.round(-40*e/100)+"px").toggle(f)}function a(){b(".scrollarea").each(function(){b(this).add(b(this).closest(".scrollareaOuter")).add(b(this).closest(".scrollable")).toggleClass("hasXScrollBar",b(this).hasScrollBar());if(b(this).hasScrollBar()&&!b(this).data("scrollIndRight")){var f=b("<div class='scrollIndicatorToRight'></div>");var e=b("<div class='scrollIndicatorToLeft'></div>");b(this).data("scrollIndRight",f);b(this).data("scrollIndLeft",e);b(this).closest(".scrollareaOuter").append(f).append(e);var g=this;var h=function(){d(b(g))};h();b(this).scroll(h)}})}function c(){b("table.orangeTable, #truppenDiv").wrap("<div class='scrollarea'></div>");b(".scrollarea").wrap("<div class='scrollareaOuter' />");a();b(window).resize(a)}b(c)})(jQuery);var ShoutBox={};(function(){var c=0;var f=60*60;var g=null;var a=5;var b=0;var e=false;function d(r){r=r.replace(/<span class='weg'>[^<>]+<\/span>/g,"");var x,j=0;while(x=r.match(/<TIME (\d+) (\d)>/)){var l=x[1]*1;var y=x[2]*1;var m=new Date();l+=TIME_OFFSET*1;l-=-m.getTimezoneOffset()*60;m.setTime(l*1000);var v=m.getHours();var o=m.getMinutes();if(o<10){o="0"+o}var k=v;if(k>12){k-=12}var t="am";if(v>=12){t="pm"}if(v==0){k=12}var w=TIME_TIME_HOURS_MINS.replace(/G/,v).replace(/g/,k).replace(/a/,t).replace(/i/i,o);var q=m.getMonth()+1;if(q<10){q="0"+q}var s=TIME_DATE_SHORT.replace(/j/,m.getDate()).replace(/d/,m.getDate()<10?"0"+m.getDate():m.getDate()).replace(/[m]/i,q).replace(/[Y]/,m.getFullYear()).replace(/[y]/,(m.getFullYear()+"").replace(/20/,""));if(y!=1){w=s+" - "+w}r=r.replace(x[0],w);j++;if(j>10000){break}}if(r.indexOf("##X##")>=0){var u=r.indexOf("##X##");ShoutBox.shoutUpdateIn=parseInt(r.substring(0,u));r=r.substring(u+5)}if(!isFinite(ShoutBox.shoutUpdateIn)){ShoutBox.shoutUpdateIn=f}else{if(ShoutBox.shoutUpdateIn<=0){ShoutBox.shoutUpdateIn=f}else{if(ShoutBox.shoutUpdateIn<10){ShoutBox.shoutUpdateIn=10}}}if(r.indexOf("##X##")>=0){var u=r.indexOf("##X##");var p=r.substring(0,u);r=r.substring(u+5);if(dge("shoutBoxOnlineList")){dge("shoutBoxOnlineList").innerHTML=p}}if(r.indexOf("##X##")>=0){var u=r.indexOf("##X##");ShoutBox.latestTimeUNIX=parseInt(r.substring(0,u));r=r.substring(u+5)}if(r!="NO_UPDATE"){dge("shoutText").innerHTML=r}i();setTimeout(ShoutBox.updateShoutScroll,1);if(e){dge("shoutInput").focus();e=false}}function i(){clearTimeout(c);ShoutBox.shoutUpdateIn-=a;var j=ShoutBox.shoutUpdateIn>60?Math.ceil(ShoutBox.shoutUpdateIn/60)+"m":ShoutBox.shoutUpdateIn+"s";dge("shoutRefreshBut").innerHTML=g+" <span style='color:#555' onmouseover='Tip(\""+j+".\");'>("+j+")</span>";if(ShoutBox.shoutUpdateIn<=0){ShoutBox.updateShout();ShoutBox.shoutUpdateIn=b}else{c=setTimeout(i,1000*a)}}function h(){try{if(!dge("shoutRefreshBut")){return}g=dge("shoutRefreshBut").innerHTML;if(b==null){b=f}if(ShoutBox.shoutUpdateIn==null){ShoutBox.shoutUpdateIn=b}i();if(dge("shoutInput")){dge("shoutInput").setAttribute("autocomplete","off")}}catch(j){alert("Fehler im Schreikasten")}}ShoutBox={shoutUpdateIn:null,latestTimeUNIX:-1,openSmileBox:function(j){dge("shoutSmileBox").innerHTML=j;dge("shoutSmileBox").style.display=dge("shoutSmileBox").style.display!="block"?"block":"none"},addShoutIcon:function(j){dge("shoutInput").value+=j;dge("shoutSmileBox").style.display="none";dge("shoutInput").focus()},addShout:function(){dge("shoutRefreshBut").innerHTML=(site_lang=="de"?"Lade ... ":"...");var j="TravianTools2.php?m=groups&gid="+GID;var l=dge("shoutInput").value;if(!l){return false}dge("shoutInput").value="";e=true;var k="action=addshout&text="+encodeURIComponent(l)+"&"+sectok;$.post(j,k,d)},shoutBoxSize:function(j){dge("shout").className="shoutBox "+(j==0?"shoutBoxSizeNorm":"shoutBoxSizeBig");dge("shoutLinkBigger").style.display=j==0?"inline":"none";dge("shoutLinkSmaller").style.display=j==0?"none":"inline";ShoutBox.updateShoutScroll()},updateShout:function(){dge("shoutRefreshBut").innerHTML=(site_lang=="de"?"Lade ... ":"...");var j="TravianTools2.php?m=groups&gid="+GID+"&getShoutBox&second=2";var k="myStandTime="+ShoutBox.latestTimeUNIX+"&"+sectok;$.post(j,k,d);ShoutBox.shoutUpdateIn=b;clearTimeout(c)},updateShoutScroll:function(){var j=dge("shoutText");j.scrollTop=isMsie()?10000:j.scrollHeight}};$(h)})();var ToolTip=(function(e){var i={sticky:false,offsetx:10,offsety:5,delay:500,fadeIn:250,maxWidth:300,duration:0};var c=10002;var d=1;var g=[-1,-1];var b={};function f(x,D,u,p){var q=this;var z=e(x);this.id=d++;var n=e.extend({},i,p);var r=0;var m=false;var w=false;var s=null;var y=false;function v(){if(s===null){e(document.body).append(s=e("<div class='ToolTip' style='display:none;'><div class='title'>...</div><div class='box'></div></div>"))}return s}function l(F){if(F==="force"||!m||!n.sticky){var E=v().is(":visible");v().show();var G={left:g[0]+n.offsetx,top:g[1]+n.offsety};var o=v().width();if(G.left+o>e(window).width()){G.left=g[0]-o-n.offsetx}G.top=Math.max(0,G.top);G.left=Math.max(0,G.left);v().offset(G).toggle(E)}}function C(){clearTimeout(r);if(!w&&!m){r=setTimeout(A,n.delay)}v().css("z-index",c++)}function t(){clearTimeout(r);m=false;delete b[q.id];v().fadeOut(n.fadeIn)}function A(){clearTimeout(r);if(y&&y>(new Date().getTime()-3*1000)){return}m=true;b[q.id]=q;v().fadeIn(n.fadeIn);e.each(b,function(o,E){if(E.id!=q.id){E.hide()}})}function B(){clearTimeout(r);if(m){r=setTimeout(function(){t()},n.duration)}}this.put=function(F,o,E){n=e.extend({},i,E);w=!F&&!o;v().toggleClass("hasTitle",!!F).toggleClass("hasNoTitle",!F).find(".title").html(F);v().find(".box").html(o);v().find(".box a.closeToolTip").click(t);v().css("max-width",n.maxWidth)};this.hide=t;e.each(z.data(),function(o,F){var E;if(E=o.match(/^tooltip_(\w+)$/)){n[E[1]]=F}});this.put(D,u,n);z.mousemove(l);z.add(v()).mouseout(B).mouseover(C);z.click(function(){if(z.is("span,.show-tip-on-click")){A();return}y=new Date().getTime();if(m){v().stop(true,true).hide();m=false}});C();l("force")}function j(q,p,n,l){if(g[0]==-1){return}var m=e(q);if(!m.data("tto")){m.data("tto",new f(q,p,n,l))}else{m.data("tto").put(p,n,l)}}function h(o){var p=e(e(document.body).find(":hover").get().reverse());var q=null;p.each(function(){if((e(this).prop("onmouseover")+"").indexOf("Tip(")>-1||(e(this).prop("onclick")+"").indexOf("Tip(")>-1){q=this;return false}});if(!q){q=p[0]}var m=e.extend({},i);for(var n=1;n<arguments.length;n++){var l=arguments[n];var r=(arguments.length>=n+1)?arguments[++n]:"";if(l==STICKY){m.sticky=!!r}else{if(l==DELAY){m.delay=r}else{if(l==OFFSETX){m.offsetx=r}else{if(l==OFFSETY){m.offsety=r}else{if(l==WIDTH){m.maxWidth=r}else{console.log("Unknown key: "+l)}}}}}}if(q){j(q,false,o,m)}else{console.log(o)}}function k(l){g=[e(document).scrollLeft()+l.clientX,e(document).scrollTop()+l.clientY]}function a(){e(this).unbind("mouseover",a);if(e(this).data("_tooltip_registered")){return}e(this).data("_tooltip_registered",true);var l=this.title.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");if(l){e(this).data("title-old",l);this.title="";j(this,"",l)}}e(function(){if(typeof window.Tip=="undefined"){window.Tip=h}window.STICKY=31;window.DELAY=12;window.OFFSETX=24;window.OFFSETY=25;window.WIDTH=39;e(document.body).mouseover(k);e("*[title!='']").mouseover(a)});return{show:j,mouseover:function(l){a.call(l)}}})(jQuery);var WeltWechsel=(function(g){var d=null;var f=0;function h(){clearTimeout(f);if(d){var m=d.nodes;var p=d.curpos;var k=0;var n=new Date().getTime();for(;(p<m.length);p++){var o=m[p];var i=true;g.each(d.suchwerte,function(r,q){i=!!(i&&o.text.indexOf(q)!=-1)});if(i!=o.$j.data("match")){k++;o.$j.data("match",i).toggle(i).toggleClass("match",i)}if(i){k++;if(d.suchwert){var l=o.$j.data("htmlorig");g.each(d.suchwerte,function(r,q){l=l.replace(new RegExp("((?:^|>)[^<>]*)("+q+")","gi"),"$1<span class='mark'>$2</span>")});o.$j.html(l)}else{o.$j.html(o.$j.data("htmlorig"))}}i&&d.found++;if(new Date().getTime()>n+100){break}}d.curpos=p;var j=d.$worldTable.find(".block .world");j.closest(".block").hide();j.filter(".match").closest(".block").show();if(d.curpos<m.length){f=setTimeout(h,50)}else{d.$o.toggleClass("error",!d.found)}}}function a(n){var k=g(n);var p=k.closest(".worldTable2");var i=k.val().toLowerCase().trim();p.find(".archivWorlds").show();p.find(".archiWorldsA").hide();var l=0;if(!p.data("_suchNodes")){var j=[];p.find(".world").each(function(q,s){var r=g(this);r.data("htmlorig",r.html());var o=(r.text()+"|"+r.data("fullname")+"|"+r.data("language")+"|"+r.data("alt")).toLowerCase();j.push({$j:r,text:o})});p.data("_suchNodes",j)}var j=p.data("_suchNodes");var m=[];g.each(i.split(" "),function(o,q){q.trim()!=""&&m.push(q.trim())});d={nodes:j,curpos:0,found:0,suchwert:i,suchwerte:m,$o:k,$worldTable:p};h()}function c(){g(".worldTable2 a").each(function(){if(g(this).data("fullname")){g(this).unbind("mouseover").mouseover(function(){var i="Server: <strong>"+g(this).data("fullname")+"</strong>";i+="<br />"+Lg("start")+": <strong>"+g(this).data("start")+"</strong>";if(typeof ToolTip!="undefined"){ToolTip.show(this,"","<div style='font-size:125%;'>"+i+"</div>",{delay:200})}else{Tip(i,FONTSIZE,"14px")}})}})}var b=null;function e(){var i=g(this);if(!b){g().popup().showLoading();var j=wwurl;var k="mode="+wwmode+"&"+sectok;g.post(wwurl,k,function(l){b=g(g("<div id='weltWechselDiv' />").html(l)).popup({close:".close",scrollableContent:".absatzBack"});setTimeout('$("#weltWechselDivInner input[type=text]").select();',5);if(!isMobile()){c()}});return}else{b.open()}}window.openWorldChooser=window.openWorldChooserAjax=e;return{startSuche:a,addHoverInfo:c,}})(jQuery);function showCookieNotice(a,g,h){var b={en:"Cookies help us deliver our services. By using our services, you agree to our use of cookies. <a href='{link}'>Learn more</a>",de:"Cookies helfen uns bei der Bereitstellung unserer Dienste. Durch die Nutzung unserer Dienste erklärst du dich mit dem Einsatz von Cookies einverstanden. <a href='{link}'>Weitere Informationen</a>",fr:"Les cookies assurent le bon fonctionnement de nos services. En utilisant ces derniers, vous acceptez l'utilisation des cookies. <a href='{link}'>En savoir plus</a>",es:"Las cookies nos permiten ofrecer nuestros servicios. Al utilizar nuestros servicios, aceptas el uso que hacemos de las cookies. <a href='{link}'>Más información</a>",nl:"Cookies helpen ons bij het leveren van onze diensten. Door gebruik te maken van onze diensten, gaat u akkoord met ons gebruik van cookies. <a href='{link}'>Meer informatie</a>",ru:"Файлы cookie необходимы для работы наших сервисов. Пользуясь нашими сервисами, вы разрешаете нам использовать файлы cookie. <a href='{link}'>Подробнее</a>",pl:"Pliki cookie pomagają nam udostępniać nasze usługi. Korzystając z tych usług, zgadzasz się na użycie plików cookie. <a href='{link}'>Więcej informacji</a>",tr:"Çerezler, hizmetlerimizi sunmamıza yardımcı olur. Hizmetlerimizi kullanarak, çerezleri kullanmamızı kabul etmiş olursunuz. <a href='{link}'>Daha fazla bilgi</a>",sl:"S piškotki si pomagamo pri zagotavljanju storitev. Z uporabo naših storitev se strinjate, da lahko uporabljamo piškotke. <a href='{link}'>Več o tem</a>",it:"I cookie ci aiutano a fornire i nostri servizi. Utilizzando tali servizi, accetti l'utilizzo dei cookie da parte nostra. <a href='{link}'>Informazioni</a>",tr:"Çerezler, hizmetlerimizi sunmamıza yardımcı olur. Hizmetlerimizi kullanarak, çerezleri kullanmamızı kabul etmiş olursunuz. <a href='{link}'>Daha fazla bilgi</a>",no:"Informasjonskapsler gjør tjenestene våre bedre. Når du bruker tjenestene, godtar du bruk av informasjonskapsler. <a href='{link}'>Mer informasjon</a>"};var e="<form method='post' class='buttonOuter' ><button class='stylebutton' type='submit' name='cookie_ok' value='1'></button> </form>";var f=$("<div />");var c=$("<footer class='cookieNotice' style='padding-right:60px;' />").html(e).find("button").html(h).click(function(){$.post(location.href,"cookie_ok_ajax=1&"+sectok,function(j){c.add(f).slideUp();$(window).off("resize",d)});return false}).end();function d(){f.height(c.outerHeight());var j=c.find("button");if(isMobile()){j.css("padding","12px 25px")}c.css("padding-right",(j.outerWidth()+20)+"px").find("form").css("line-height",c.outerHeight()+"px")}var i=(b[a]||b.en).replace(/{link}/g,g);c.append($("<div style='text-align:center;' />").html(i)).find("a").prop("rel","nofollow");$(document.body).append(c).append(f);$(window).resize(d).each(d)}function enhancedAutoComplete(b,a){return this.each(function(){var c=$(this);$(this).autocomplete({minLength:a||1,source:function(f,e){if(c.data("_lastSetValue")===f.term){e();return}var d={action:b,wwmode:(typeof wwmode==="string"?wwmode:null),searchterm:f.term};Ajax.postGlobal(d,function(g){e(g.values)},function(){e()})},select:function(d,e){var f=unhtml(e.item.value);if(e.item.gotourl){location.href=e.item.gotourl;$(this).val(f+"...");$().popup().showLoading();return false}if(e.item.overlay){$(this).data("overlayvalue",f).closest(".xuser-input").find(".overlay").html(e.item.overlay)}$(this).val(f).data("_lastSetValue",f).blur().change()},}).data("ui-autocomplete")._renderItem=function(d,e){return $("<li></li>").data("item.autocomplete",e).append("<a style='display:block;'>"+e.label+"</a>").appendTo(d)}})}$.fn.autoCompleteXUsernames=function(){return enhancedAutoComplete.call(this,"ajax-xusername-search")};$.fn.autoCompleteActiveXUsernames=function(){return enhancedAutoComplete.call(this,"ajax-active-xusername-search")};$.fn.autoCompleteXAllys=function(){return enhancedAutoComplete.call(this,"ajax-xallys-search")};$.fn.autoCompleteGlobalSearch=function(){return enhancedAutoComplete.call(this,"ajax-global-search",1)};$.fn.directEdit=function(){return this.each(function(){var $input=$(this);var postUrl=$input.data("url")||location.href;var $directEditDiv=$(this).parent(".direct-edit");var $wrap=null;if($directEditDiv.size()>0){$wrap=$directEditDiv}else{$input.wrap($("<div class='direct-edit' />"));var display=$input.css("display");display=display==="inline"?"inline-block":display;$wrap=$input.parent();$.each(["width","height","min-width","min-height","max-width","max-height"],function(key,cssname){$wrap[0].style[cssname]=$input[0].style[cssname];$input.css(cssname,"")});if(!$wrap[0].style.width&&!$wrap[0].style["min-width"]&&!$wrap[0].style["min-width"]){$wrap.width($input.outerWidthV())}if(!$wrap[0].style.height&&!$wrap[0].style["min-height"]&&!$wrap[0].style["min-height"]){$wrap.height($input.outerHeightV())}$input.css("width","100%").css("height","100%")}var $notifier=$("<span class='notification' ><span class='icon' /></span>").css("margin-top",Math.round(($wrap.heightV()-16)/2)+"px");$wrap.append($notifier);function clicked(){setNotification("")}function setNotification(status){$notifier.prop("title",unhtml(Lg("edit-status-"+status,{name:""}))).add($notifier.find(".icon")).removeClass("loading ok error").stop(true,true);$input.removeClass("loading ok error").addClass(status);if(status){$notifier.addClass(status).show();$notifier.find(".icon").hide().fadeIn(250,function(){if($notifier.hasClass("ok")){$notifier.fadeOut(8000)}})}else{$notifier.hide()}}function ajaxNewValueSuccess(data,t,r){if(data.precontent){$directEditDiv.find(".precontent").html(data.precontent)}if(data.noIngameNickWarning){$(".noIngameNickWarning").toggle(data.noIngameNickWarning==="show")}if(data.overlay){$($input).closest(".xuser-input").find(".overlay").html(data.overlay)}if($input.data("errordivselector")){$($input.data("errordivselector")).html(data.error||"").toggle(!!data.error)}if(data.error){return ajaxNewValueFailed(r)}var thatLateOnSuccess=this.lateOnSuccess;setTimeout(function(){try{thatLateOnSuccess()}catch(e){}setNotification("ok")},300);return}function ajaxNewValueFailed(r){setNotification("error");if($input.is("select")){$input.val(lastOkValue).change()}$input.prop("disabled",false);$input.data("onDisabledChange")&&$input.data("onDisabledChange")()}function submitNewValue(val,onSuccess){setNotification("loading");var tmp=null;var ajaxData={};if(tmp=$input.data("postname")){ajaxData[tmp]=val}else{if(tmp=$input.data("post")){var VALUE=val;var ajaxData=null;eval("ajaxData="+tmp+";")}}if(isMobile()){$input.blur()}if(count(ajaxData)>0){sendAjaxCall(ajaxData,ajaxNewValueSuccess,ajaxNewValueFailed,{lateOnSuccess:onSuccess,url:postUrl})}else{console.error("Missing post data");ajaxNewValueFailed()}}var lastOkValue=$input.val();var lastSubmittedValue="_#_";function inputChanged(){if($input.is("select")&&$input.val()==lastOkValue){return}var value=$input.is("input[type=checkbox]")?($input.prop("checked")?1:0):$input.val();if(lastSubmittedValue===value){return}lastSubmittedValue=value;$input.prop("disabled",true);$input.data("onDisabledChange")&&$input.data("onDisabledChange")();submitNewValue(value,function(){lastOkValue=value;$input.removeClass("disabled");$input.prop("disabled",false);$input.data("onDisabledChange")&&$input.data("onDisabledChange")()})}$input.change(inputChanged)})};$.fn.moveToBody=function(){return this.each(function(){var b=$(this);var a=b.data("fn.moveToBody.placeholder");if(a){a.replaceWith(b.css("top",0).css("left",0).css("position",b.data("fn.moveToBody.oldPosition")).css("z-index",b.data("fn.moveToBody.oldZIndex")));a=null}else{a=$("<div />").width(b.width()).height(b.height()).css("display",b.css("display"));if(b.css("display")==="inline-block"){a.css("vertical-align","middle")}b.after(a);var c=b.offset();b.data("fn.moveToBody.oldPosition",b.css("position"));b.data("fn.moveToBody.oldZIndex",b.css("z-index"));b.appendTo($(document.body)).css("position","absolute").css("z-index",101).offset(c)}b.data("fn.moveToBody.placeholder",a)})};$.fn.makeParentsVisible=function(){return this.each(function(){var a=[];$($(this).parents().get().reverse()).each(function(){if($(this).is(":hidden")){a.push([this,this.style.display]);$(this).show()}});$(this).data("_pVMods",a)})};$.fn.restoreParentsVisibility=function(){return this.each(function(){$.each($(this).data("_pVMods"),function(b,a){a[0].style.display=a[1]})})};(function(){function a(e,c){if(c){console.error("Nicht vorgesehen!");return null}var b=this[e]();if(b<=0){b=this.makeParentsVisible()[e]();this.restoreParentsVisibility()}return b}$.fn.widthV=function(b){return a.call(this,"width",b)};$.fn.heightV=function(b){return a.call(this,"height",b)};$.fn.outerWidthV=function(b){return a.call(this,"outerWidth",b)};$.fn.outerHeightV=function(b){return a.call(this,"outerHeight",b)}})();$.fn.showLoading=function(){return this.each(function(){$(this).append($("<div class='loading-dunkelheit' />").fadeIn())})};$.fn.removeLoading=function(){return this.each(function(){$(this).find(".loading-dunkelheit").remove()})};(function(){var a=null;var c=$();function h(){var i=location.href;window.addEventListener("popstate",function(){if(i.indexOf("#popup")>-1&&location.href.indexOf("#popup")==-1){g()}i=location.href})}function g(){a.add(c).fadeOut();if(location.href.indexOf("#popup")>-1){location.href="#"}c.find("input:focus").blur()}function f(){if(a===null){a=$("<div class='popup-dunkelheit' />");$(document.body).append(a);a.click(g);h()}return a}function e(j,i){j.addClass("popup");i=$.extend({close:".close"},i);this.open=function(){j.add(f().removeClass("popup-loading")).fadeIn();this.update();setTimeout(this.update,1);if(j.length>0){document.documentElement.scrollTop=0}location.href=location.href.split("#")[0]+"#popup"};this.close=function(){j.add(f()).fadeOut();j.find("input:focus").blur()};this.update=function(){var n=isMobile()?15:50;var m=i.scrollableContent?j.find(i.scrollableContent):j;m.css("overflow","hidden").css("max-height","");var l=Math.max(n,Math.round(($(window).height()-j.height())/2));if(i.top){n=l=i.top}var k=Math.round($(window).height()-n-(b?0:20));j.css({top:l+"px",left:"50%","margin-left":-Math.round(j.outerWidth()/2)+"px","max-width":Math.round($(window).width()-20)+"px"});if(i.scrollableContent){m.css({});k-=m.position().top+intval(m.css("padding-top"))+intval(m.css("padding-bottom"))}m.css({overflow:"auto","max-height":k+"px"})};this.showLoading=function(){this.open();f().addClass("popup-loading")}}$.fn.popup=function(j){j=$.extend({close:".close"},j);var i=new e(this,j);this.each(function(){var k=$(this).data("popup",i);c=c.add(k);$(document.body).append(k.hide());k.show();k.css({"z-index":10001,position:"absolute",overflow:"hidden"});k.find(j.close).click(i.close);setTimeout(i.update,1);k.hide();i.open()});return i};var b=false;var d=false;$(window).resize(function(){var i=[$(window).width(),$(window).height()];if(d&&d[0]==i[0]&&Math.abs(d[1]-i[1])>0){var j=d[1]-i[1];if(j/i[1]>0.3){b=true}if(j/i[1]<0.3){b=false}}d=i;if(c.length>0){c.filter(":visible").each(function(){$(this).data("popup").update()})}})})();(function(){var a=$();$(function(){$(document.body).click(function(b){if(a.length>0){a.each(function(){if($(this).find(b.target).size()==0){$(this).data("onOuterClick")()}})}})});$.fn.selectHtmlize=function(){function b(e){var d="";if(e.is("select")){d+="<div class='de-htmlselect'>";d+="<div class='select-values'>";e.find("option").each(function(){var g=$(this);var h=g.data("html")||g.text();var f;if(f=h.match(/^(<img [^>]*abs[^>]*>)(.*)$/)){h=f[1]+"<span class='abs'>"+f[2]+"</span>"}d+="<span class='value' data-value='"+g.prop("value")+"' >"+h+"</span>"});d+="</div>";d+="<span class='deh-pfeil'>⇩</span>";d+="</div>"}e.wrap($("<div class='direct-edit' data-postname='"+e.prop("name")+"' ></div>")).hide();var c=e.parent();c.append(d);c.css("display",c.find(".de-htmlselect").css("display"));return c}return this.each(function(){var d=$(this);var c=b(d).data("$origInput",d);c.find(".de-htmlselect").each(function(){var i=$(this);var j=i.find(".select-values");function h(){if(j.find(".value.selected").data("value")==d.val()){return}j.find(".value").removeClass("selected").each(function(){if($(this).data("value")==d.val()){$(this).addClass("selected");return false}})}h();var g=null;function f(){if(d.prop("disabled")){return}if(i.hasClass("open")){e();if(!$(this).hasClass("selected")){j.find(".value").removeClass("selected").filter(this).addClass("selected");d.val($(this).data("value")).change()}}else{i.addClass("open");j.css("margin-top",(0.5-j.find(".selected").position().top)+"px");c.moveToBody();setTimeout(function(){a=a.add(i.data("onOuterClick",e))},1)}}function e(){if(i.hasClass("open")){c.moveToBody();i.removeClass("open");j.css("margin-top","0")}a=a.not(i)}c.width(function(){var k=20;j.find(".value").each(function(){k=Math.max(k,$(this).css("display","inline").widthV());$(this).css("display","")});k+=40;return k}).height(i.heightV());j.find(".value").add(i.find(".deh-pfeil")).bind("click",f);d.change(function(){h()});d.data("onDisabledChange",function(){i.toggleClass("disabled",d.prop("disabled"))})})})}})();$(function(){function c(g){var f=$(g.target);if(f.is("#dorfButSuchSpieler, #rapidModeAddFeindInput")){f.autoCompleteXUsernames()}if(f.is(".ajax-gsearch")){loadJQueryUI(function(){f.autoCompleteGlobalSearch()})}if(f.is(".ajax-xusername-search")){loadJQueryUI(function(){f.autoCompleteXUsernames()})}if(f.is(".ajax-active-xusername-search")){loadJQueryUI(function(){f.autoCompleteActiveXUsernames()})}if(f.is(".ajax-xallys-search")){loadJQueryUI(function(){f.autoCompleteXAllys()})}if(f.is(".load-feedback")){f.addClass("elmClicked");if(f.is("a[target=_blank]")){setTimeout(function(){f.removeClass("elmClicked")},5000)}}if(f.is("button")){$(this).blur()}if(f.is("a[data-althref]")){location.href=f.data("althref");return false}}function a(){$(document.body).toggleClass("mobile",isMobile())}function b(){var e=$(this).val();var f={};$(".content").showLoading().find("input[name],select[name],textarea[name]").each(function(){f[$(this).prop("name")]=$(this).val()});Ajax.postLocal({fetchContent:1,tversion:e},function(g){$(".content").html(g.content).removeLoading().gt2live();$.each(f,function(h,j){$(".content").find("[name="+h+"]").val(j);if(g.replaceLocation){try{window.history.pushState({},"",g.replaceLocation)}catch(i){console.log(i)}}})})}function d(f){f.find("select.select-html").selectHtmlize();f.find("select.direct-edit,input.direct-edit,textarea.direct-edit").directEdit();f.find(".js-clear-overlay-on-change").bind("keyup change",function(){if($(this).data("overlayvalue")!==$(this).val()){$(this).closest(".xuser-input").find(".overlay").html("")}});f.find(".js-calcout-leftpadding").each(function(){$(this).css("padding-left",$(this).css("padding-left"));var g=intval($(this).css("padding-left"));var h=intval($(this).css("padding-left","").css("padding-left"));$(this).width($(this).widthV());$(this).css("padding-left",g+"px")});f.find("input.qsuche").prop("autocomplete","off").bind("mousedown mouseout click",function(g){g.type==="mousedown"&&!$(this).is(":focus")&&$(this).data("selectOnNextClick",1);g.type==="click"&&$(this).data("selectOnNextClick")&&$(this).data("selectOnNextClick",0).select()});function e(){$("input[name=tworver]").each(function(){$(this).closest("label").toggleClass("formstd-transp",!$(this).prop("checked"))})}$("input[name=tworver]").each(e).change(e)}$.fn.gt2live=function(){d(this);return this};$(document.body).click(c);$(window).resize(a());$(".content").on("change","select[name=tversion].reloadContentOnChange",b);$(document.body).gt2live()});function showOpenTipCity(h,f,j){var a=j.innerHTML;var i=TRAVIAN_SERVER+"/karte.php?z="+getTravKoords(h,f);var b=TRAVIAN_SERVER+"/a2b.php?z="+getTravKoords(h,f);if(tversion>=4){i=TRAVIAN_SERVER+"/karte.php?x="+h+"&amp;y="+f;b=TRAVIAN_SERVER+"/build.php?id=39&tt=2&z="+getTravKoords(h,f)}if(tversion>=5){var d=536887296+h+f*32768;i=TRAVIAN_SERVER+"/#/page:map/cellId:"+d+"/window:mapCellDetails";b=TRAVIAN_SERVER+"/#/page:map/x:"+h+"/y:"+f+"/window:sendTroops"}if(typeof ToolTip!="undefined"){e="<div class='mini-menu'>"+(TRAVIAN_SERVER?"<a href='"+i+"' target=_blank>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a>":"")+(TRAVIAN_SERVER?"<a href='"+b+"' target=_blank>&nbsp;<img src='"+getTUImgFile(1,1)+"' />&nbsp;"+Ltip.sendTrp+"</a>":"")+"<hr /><a class='closeToolTip'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></div>";g="<img src='"+BASE_DIR+"img/dorf3_15.png' align=absmiddle /> "+a;ToolTip.show(j,g,e,{offsety:-25,offsetx:35,sticky:true,duration:1000});return}var e="<table style='white-space:nowrap;' class='mauspopup emu-cs0 emu-cp0'>"+(TRAVIAN_SERVER!=""?"<tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+i+"' target=_blank>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a></td></tr>":"")+(TRAVIAN_SERVER!=""?"<tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+b+"' target=_blank>&nbsp;<img src='"+getTUImgFile(1,1)+"' />&nbsp;"+Ltip.sendTrp+"</a></td></tr>":"")+"<tr><td style='height:1px;background:black;padding:0px;' colspan=2></td></tr><tr><td style='height:16px;'><a style='display:block;width:200px;' onclick='Tip(\"\");'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></td></tr></table>";var g="<div style='padding:2px 5px;font-size:13px;white-space:nowrap;'><img src='"+BASE_DIR+"img/dorf3_15.png' align=absmiddle /> "+a+"</div>";myOpenTip(e,g)}function showOpenTipPlayer(d,a,j,e){var b=j.innerHTML.replace(/<[^>]*>/g,"");var g=j.href;var i=TRAVIAN_SERVER+"/spieler.php?uid="+d;if(tversion>=5){i=TRAVIAN_SERVER+"/#/page:map/window:playerProfile/playerId:"+d}e=e?e:0;if(typeof ToolTip!="undefined"){h="<img src='"+BASE_DIR+"img/dorf3_15.png' align=absmiddle /> "+name;f="<div class='mini-menu'>"+(g?"<a href='"+g+"' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnInNWin+"</a>":"")+(e?"<a onclick='openTTMemberProfile("+e+");' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnMemberProfile+"</a>":"")+(TRAVIAN_SERVER!=""?"<a href='"+i+"' target='_blank'>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a>":"")+"<hr /><a class='closeToolTip'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></table>";h=(a>0?"<img src='"+getImgCfg().base+(a)+"."+getImgCfg().unitImgExt+"' align=absmiddle />":"")+" "+b;ToolTip.show(j,h,f,{offsety:-25,offsetx:35,sticky:true,duration:1000});return}var f="<table style='white-space:nowrap;border:0px outset #EEE;' class='mauspopup emu-cs0 emu-cp0'>"+(g?"<tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+g+"' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnInNWin+"</a></td></tr>":"")+(e?"<tr><td style='height:16px;'><a style='display:block;width:200px;' onclick='openTTMemberProfile("+e+");' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnMemberProfile+"</a></td></tr>":"")+(TRAVIAN_SERVER!=""?"<tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+i+"' target=_blank>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a></td></tr>":"")+"<tr><td style='height:1px;background:black;padding:0px;' colspan=2></td></tr><tr><td style='height:16px;'><a style='display:block;width:200px;' onclick='Tip(\"\");'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></td></tr></table>";var h="<div style='position:relative;padding:2px 5px;font-size:14px;white-space:nowrap;'>&nbsp;<div style='left:5px;top:2px;color:black;position:absolute;'>"+(a>0?"<img src='"+getImgCfg().base+(a)+"."+getImgCfg().unitImgExt+"' align=absmiddle />":"")+" "+b+"</div><div style='left:4px;top:1px;color:#DDF;position:absolute;'>"+(a>0?"<img src='"+getImgCfg().base+(a)+"."+getImgCfg().unitImgExt+"' align=absmiddle />":"")+" "+b+"</div></div>";myOpenTip(f,h)}function showOpenTipAlly(e,b){var a=b.innerHTML;var d=b.href;var h=TRAVIAN_SERVER+"/allianz.php?aid="+e;if(tversion>=5){h=TRAVIAN_SERVER+"/#/page:map/allianceId:"+e+"/window:alliance"}if(typeof ToolTip!="undefined"){g="<div class='mini-menu'><a href='"+d+"' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnInNWin+"</a>"+(TRAVIAN_SERVER?"<a href='"+h+"' target=_blank>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a>":"")+"<hr /><a class='closeToolTip'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></div>";f=a;ToolTip.show(b,f,g,{offsety:-25,offsetx:35,sticky:true,duration:1000});return}var g="<table style='white-space:nowrap;' class='mauspopup emu-cs0 emu-cp0'><tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+d+"' target=_blank>&nbsp;<img src='"+BASE_DIR+"img/neuesFenster.gif' />&nbsp;"+Ltip.opnInNWin+"</a></td></tr>"+(TRAVIAN_SERVER!=""?"<tr><td style='height:16px;'><a style='display:block;width:200px;' href='"+h+"' target=_blank>&nbsp;<img src='"+getImgCfg().travIcon+"' />&nbsp;"+Ltip.opnInTrav+"</a></td></tr>":"")+"<tr><td style='height:1px;background:black;padding:0px;' colspan=2></td></tr><tr><td style='height:16px;'><a style='display:block;width:200px;' onclick='Tip(\"\");'>&nbsp;<img src='"+BASE_DIR+"img/close.png' height=14 />&nbsp;"+Ltip.close+"</a></td></tr></table>";var f="<div style='position:relative;padding:2px 5px;font-size:14px;white-space:nowrap;'>&nbsp;<div style='left:5px;top:2px;color:black;position:absolute;'> "+a+"</div><div style='left:4px;top:1px;color:#DDF;position:absolute;'> "+a+"</div></div>";myOpenTip(g,f)};